<!DOCTYPE html><meta charset=utf8><meta name=viewport content="width=device-width, user-scalable=0"><title>GoodLuck (opt)</title><style>body,html{margin:0;overflow:hidden}canvas,main{height:100vh;position:absolute;user-select:none;width:100vw}</style><canvas id=scene></canvas><canvas id=billboard></canvas><main></main><script>!function(){function t(t,n){let i=t.i.t();for(let o of n)o(t,i);return i}function n(...n){return(i,o)=>{let e=[];for(let o of n){let n=t(i,o);e.push(n)}i.i.o[o]|=32,i.i.l[o]={l:e}}}function*i(t,n,o){if((t.o[n]&o)===o&&(yield n),32&t.o[n])for(let e of t.l[n].l)yield*i(t,e,o)}function o(t,n){if(32&t.o[n])for(let i of t.l[n].l)o(t,i);t.h(n)}function e(t,n,i){switch(n){case 0:document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen();break;case 1:{let[n]=i;o(t.i,n),t.u++;break}case 2:t._++}}function r(t,n,i,o){return t.bindTexture(sn,n),t.texImage2D(sn,0,32856,i,o,0,6408,5121,null),t.texParameteri(sn,10241,an),t.texParameteri(sn,10240,an),n}function l(t,n,i,o){return t.bindTexture(sn,n),t.texImage2D(sn,0,33190,i,o,0,6402,5125,null),t.texParameteri(sn,10241,an),t.texParameteri(sn,10240,an),t.texParameteri(sn,34892,34894),t.texParameteri(sn,10242,33071),t.texParameteri(sn,10243,33071),n}function a(t,n,i){let o={m:t.createFramebuffer(),v:n,g:i,p:r(t,t.createTexture(),n,i),M:l(t,t.createTexture(),n,i)};t.bindFramebuffer(fn,o.m),t.framebufferTexture2D(fn,36096,sn,o.M,0),t.framebufferTexture2D(fn,36064,sn,o.p,0);let e=t.checkFramebufferStatus(fn);if(36053!=e)throw Error(`Failed to set up the framebuffer (${e}).`);return o}function s(t,n,i){let o=t.createProgram();if(t.attachShader(o,c(t,35633,n)),t.attachShader(o,c(t,35632,i)),t.linkProgram(o),!t.getProgramParameter(o,35714))throw Error(t.getProgramInfoLog(o));return o}function c(t,n,i){let o=t.createShader(n);if(t.shaderSource(o,i),t.compileShader(o),!t.getShaderParameter(o,35713))throw Error(t.getShaderInfoLog(o));return o}function f(t,n,i){return Math.max(t,Math.min(n,i))}function h(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function u(t,n){let i=n[0],o=n[1],e=n[2],r=n[3],l=n[4],a=n[5],s=n[6],c=n[7],f=n[8],h=n[9],u=n[10],_=n[11],m=n[12],d=n[13],v=n[14],g=n[15],p=i*a-o*l,w=i*s-e*l,y=i*c-r*l,x=o*s-e*a,M=o*c-r*a,T=e*c-r*s,b=f*d-h*m,z=f*v-u*m,A=f*g-_*m,S=h*v-u*d,F=h*g-_*d,k=u*g-_*v,P=p*k-w*F+y*S+x*A-M*z+T*b;return P?(P=1/P,t[0]=(a*k-s*F+c*S)*P,t[1]=(e*F-o*k-r*S)*P,t[2]=(d*T-v*M+g*x)*P,t[3]=(u*M-h*T-_*x)*P,t[4]=(s*A-l*k-c*z)*P,t[5]=(i*k-e*A+r*z)*P,t[6]=(v*y-m*T-g*w)*P,t[7]=(f*T-u*y+_*w)*P,t[8]=(l*F-a*A+c*b)*P,t[9]=(o*A-i*F-r*b)*P,t[10]=(m*M-d*y+g*p)*P,t[11]=(h*y-f*M-_*p)*P,t[12]=(a*z-l*S-s*b)*P,t[13]=(i*S-o*z+e*b)*P,t[14]=(d*w-m*x-v*p)*P,t[15]=(f*x-h*w+u*p)*P,t):null}function _(t,n,i){let o=n[0],e=n[1],r=n[2],l=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=n[8],u=n[9],_=n[10],m=n[11],d=n[12],v=n[13],g=n[14],p=n[15],w=i[0],y=i[1],x=i[2],M=i[3];return t[0]=w*o+y*a+x*h+M*d,t[1]=w*e+y*s+x*u+M*v,t[2]=w*r+y*c+x*_+M*g,t[3]=w*l+y*f+x*m+M*p,w=i[4],y=i[5],x=i[6],M=i[7],t[4]=w*o+y*a+x*h+M*d,t[5]=w*e+y*s+x*u+M*v,t[6]=w*r+y*c+x*_+M*g,t[7]=w*l+y*f+x*m+M*p,w=i[8],y=i[9],x=i[10],M=i[11],t[8]=w*o+y*a+x*h+M*d,t[9]=w*e+y*s+x*u+M*v,t[10]=w*r+y*c+x*_+M*g,t[11]=w*l+y*f+x*m+M*p,w=i[12],y=i[13],x=i[14],M=i[15],t[12]=w*o+y*a+x*h+M*d,t[13]=w*e+y*s+x*u+M*v,t[14]=w*r+y*c+x*_+M*g,t[15]=w*l+y*f+x*m+M*p,t}function m(t,n,i,o,e){let r,l=1/Math.tan(n/2);return t[0]=l/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(r=1/(o-e),t[10]=(e+o)*r,t[14]=2*e*o*r):(t[10]=-1,t[14]=-2*o),t}function d(t,n){return t[0]=n[8],t[1]=n[9],t[2]=n[10],T(t,t)}function v(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function g(t,n){let i=function(t,n){let i=n[4],o=n[5],e=n[6],r=n[8],l=n[9],a=n[10];return t[0]=Math.hypot(n[0],n[1],n[2]),t[1]=Math.hypot(i,o,e),t[2]=Math.hypot(r,l,a),t}([0,0,0],n),o=1/i[0],e=1/i[1],r=1/i[2],l=n[0]*o,a=n[1]*e,s=n[2]*r,c=n[4]*o,f=n[5]*e,h=n[6]*r,u=n[8]*o,_=n[9]*e,m=n[10]*r,d=l+f+m,v=0;return d>0?(v=2*Math.sqrt(d+1),t[3]=.25*v,t[0]=(h-_)/v,t[1]=(u-s)/v,t[2]=(a-c)/v):l>f&&l>m?(v=2*Math.sqrt(1+l-f-m),t[3]=(h-_)/v,t[0]=.25*v,t[1]=(a+c)/v,t[2]=(u+s)/v):f>m?(v=2*Math.sqrt(1+f-l-m),t[3]=(u-s)/v,t[0]=(a+c)/v,t[1]=.25*v,t[2]=(h+_)/v):(v=2*Math.sqrt(1+m-l-f),t[3]=(a-c)/v,t[0]=(u+s)/v,t[1]=(h+_)/v,t[2]=.25*v),t}function p(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function w(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t}function y(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t}function x(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function M(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function T(t,n){let i=n[0],o=n[1],e=n[2],r=i*i+o*o+e*e;return r>0&&(r=1/Math.sqrt(r)),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function b(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function z(t,n,i){let o=n[0],e=n[1],r=n[2],l=i[3]*o+i[7]*e+i[11]*r+i[15];return l=l||1,t[0]=(i[0]*o+i[4]*e+i[8]*r+i[12])/l,t[1]=(i[1]*o+i[5]*e+i[9]*r+i[13])/l,t[2]=(i[2]*o+i[6]*e+i[10]*r+i[14])/l,t}function A(t,n,i){return y(t,z([0,0,0],n,i),v([0,0,0],i))}function S(t,n,i,o){let e=n[0],r=n[1],l=n[2];return t[0]=e+o*(i[0]-e),t[1]=r+o*(i[1]-r),t[2]=l+o*(i[2]-l),t}function F(t,n,i){let o=n[0],e=n[1],r=n[2],l=n[3],a=i[0],s=i[1],c=i[2],f=i[3];return t[0]=o*f+l*a+e*c-r*s,t[1]=e*f+l*s+r*a-o*c,t[2]=r*f+l*c+o*s-e*a,t[3]=l*f-o*a-e*s-r*c,t}function k(t,n,i,o){let e=Math.sin(n/2*Xn),r=Math.cos(n/2*Xn),l=Math.sin(i/2*Xn),a=Math.cos(i/2*Xn),s=Math.sin(o/2*Xn),c=Math.cos(o/2*Xn);return t[0]=e*a*c+r*l*s,t[1]=r*l*c-e*a*s,t[2]=r*a*s-e*l*c,t[3]=r*a*c+e*l*s,t}function P(t){return 57.29577951308232*Math.asin(-f(-1,1,2*(t[1]*t[2]-t[3]*t[0])))}function C(t,n,i){let o=i/2;return t[0]=Math.sin(o)*n[0],t[1]=Math.sin(o)*n[1],t[2]=Math.sin(o)*n[2],t[3]=Math.cos(o),t}function R(t,n,i,o){let e,r,l,a,s,c=n[0],f=n[1],h=n[2],u=n[3],_=i[0],m=i[1],d=i[2],v=i[3];return r=c*_+f*m+h*d+u*v,r<0&&(r=-r,_=-_,m=-m,d=-d,v=-v),1-r>1e-6?(e=Math.acos(r),l=Math.sin(e),a=Math.sin((1-o)*e)/l,s=Math.sin(o*e)/l):(a=1-o,s=o),t[0]=a*c+s*_,t[1]=a*f+s*m,t[2]=a*h+s*d,t[3]=a*u+s*v,t}function L(t,n,i){let o=t.i.T[n],e=t.i.A[n];if(e.S){let t=e.F[e.S];t&&t!==e.k&&(0===e.k.P?e.k=t:1&e.k.C&&(e.k.P=0,e.k=t)),e.S=void 0}let r=null,l=null;for(let t of e.k.R){if(e.k.P<t.L){l=t;break}r=t}if(r&&l){let t=(e.k.P-r.L)/(l.L-r.L);l.I&&(t=l.I(t)),r.K&&l.K&&(S(o.K,r.K,l.K,t),o.V=!0),r.X&&l.X&&(R(o.X,r.X,l.X,t),o.V=!0),r.D&&l.D&&(S(o.D,r.D,l.D,t),o.V=!0)}let a=e.k.P+i;if(a<e.k.B)e.k.P=a;else{if(e.k.P=0,4&e.k.C)for(let t of e.k.R.reverse())t.L=e.k.B-t.L;2&e.k.C||(e.k=e.F.idle)}}function I(t,n){let i=t.i.T[n];var o,e;v(Hn,i.i),d($n,i.i),(o=Gn)[0]=(e=i.i)[4],o[1]=e[5],o[2]=e[6],T(o,o);let r=t.Audio.listener;r.positionX?(r.positionX.value=Hn[0],r.positionY.value=Hn[1],r.positionZ.value=Hn[2],r.forwardX.value=$n[0],r.forwardY.value=$n[1],r.forwardZ.value=$n[2],r.upX.value=Gn[0],r.upY.value=Gn[1],r.upZ.value=Gn[2]):(r.setPosition(...Hn),r.setOrientation(...$n,...Gn))}function K(t,n,i,o,e){let r=t.currentTime+e,l=0;n&&n.connect(t.destination);let a,s,c=t.createGain();if(c.gain.value=(i[0]/9)**3,i[5]&&(s=t.createOscillator(),s.type=i[5],s.frequency.value=(i[7]/3)**3,a=t.createGain(),a.gain.value=(i[6]+3)**3,s.connect(a)),i[1]){let o=t.createBiquadFilter();o.type=i[1],o.frequency.value=2**i[2],o.Q.value=i[3]**1.5,a&&i[4]&&a.connect(o.detune),c.connect(o),o.connect(n||t.destination)}else c.connect(n||t.destination);for(let n of i[8]){let i=t.createGain();i.connect(c);let e=(n[1]/9)**3,s=(n[2]/9)**3,f=(n[3]/9)**3,h=s+f+(n[4]/6)**3;if(i.gain.setValueAtTime(0,r),i.gain.linearRampToValueAtTime(e,r+s),i.gain.setValueAtTime(e,r+s+f),i.gain.exponentialRampToValueAtTime(1e-5,r+h),n[0]){let e=t.createOscillator();e.type=n[0],e.connect(i),e.detune.value=3*(n[5]-7.5)**3,a&&n[6]&&a.connect(e.detune);let l=440*2**((o-69)/12);if(n[7]){let t=(n[8]/9)**3,i=(n[9]/9)**3,o=(n[10]/6)**3;e.frequency.linearRampToValueAtTime(0,r),e.frequency.linearRampToValueAtTime(l,r+t),e.frequency.setValueAtTime(l,r+t+i),e.frequency.exponentialRampToValueAtTime(1e-5,r+t+i+o)}else e.frequency.setValueAtTime(l,r);e.start(r),e.stop(r+h)}else{let n=t.createBufferSource();n.buffer=V(t),n.loop=!0,n.connect(i),n.start(r),n.stop(r+h)}h>l&&(l=h)}s&&(s.start(r),s.stop(r+l))}function V(t){if(!Bn){Bn=t.createBuffer(1,2*t.sampleRate,t.sampleRate);let n=Bn.getChannelData(0);for(let t=0;t<n.length;t++)n[t]=2*Math.random()-1}return Bn}function X(t,n,i){let o=t.i.H[n],e=t.i.T[n];if(o.k&&(o.P+=i,o.P>o.k.$?o.k=void 0:o.G&&E(o.G,e)),o.S&&!o.k){switch(o.S.W){case 0:!function(t,n,i){let o=t.createBufferSource();o.buffer=i.N,n?(o.connect(n),n.connect(t.destination)):o.connect(t.destination),o.start()}(t.Audio,o.G,o.S);break;case 1:!function(t,n,i){let o=60/(i.j||120)/4;for(let e of i.U)for(let i=0;i<e.Y.length;i++)e.Y[i]&&K(t,n,e.O,e.Y[i],i*o)}(t.Audio,o.G,o.S)}o.k=o.S,o.P=0,o.G&&E(o.G,e)}o.S=o.q}function E(t,n){v(Nn,n.i),d(jn,n.i),t.positionX?(t.positionX.value=Nn[0],t.positionY.value=Nn[1],t.positionZ.value=Nn[2],t.orientationX.value=jn[0],t.orientationY.value=jn[1],t.orientationZ.value=jn[2]):(t.setPosition(...Nn),t.setOrientation(...jn))}function D(t,n){n>1?(m(t.J,t.Z,n,t.tt,t.nt),u(t.it,t.J)):(m(t.J,t.Z/n,n,t.tt,t.nt),u(t.it,t.J))}function B(t){!function(t,n,i,o,e,r,l){let a=1/(e-i),s=1/(o-n),c=1/(r-l);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*a,t[13]=(n+o)*s,t[14]=(l+r)*c,t[15]=1}(t.J,t.ot,t.ot,-t.ot,-t.ot,t.tt,t.nt),u(t.it,t.J)}function H(t,n){let i,o,e,r,l,a;v(n.et,t),i=r=n.et[0],o=l=n.et[1],e=a=n.et[2];let s=[0,0,0];for(let c=0;c<8;c++){let f=Yn[c];s[0]=f[0]*n.rt[0],s[1]=f[1]*n.rt[1],s[2]=f[2]*n.rt[2],z(s,s,t),s[0]<i&&(i=s[0]),s[0]>r&&(r=s[0]),s[1]<o&&(o=s[1]),s[1]>l&&(l=s[1]),s[2]<e&&(e=s[2]),s[2]>a&&(a=s[2])}n.lt=[i,o,e],n.at=[r,l,a],n.st[0]=(r-i)/2,n.st[1]=(l-o)/2,n.st[2]=(a-e)/2}function $(t,n){let i=t.et[0]-n.et[0],o=t.st[0]+n.st[0]-Math.abs(i),e=t.et[1]-n.et[1],r=t.st[1]+n.st[1]-Math.abs(e),l=t.et[2]-n.et[2],a=t.st[2]+n.st[2]-Math.abs(l);return o<r&&o<a?[o*Math.sign(i),0,0]:r<a?[0,r*Math.sign(e),0]:[0,0,a*Math.sign(l)]}function G(t,n){return t.lt[0]<n.at[0]&&t.at[0]>n.lt[0]&&t.lt[1]<n.at[1]&&t.at[1]>n.lt[1]&&t.lt[2]<n.at[2]&&t.at[2]>n.lt[2]}function W(t,n,i){for(let o=0;o<i;o++){let i=n[o],e=t.o&i.ct,r=i.o&t.ct;if((e||r)&&G(t,i)){let n=$(t,i);e&&t.ft.push({ht:i.Entity,ut:n}),r&&i.ft.push({ht:t.Entity,ut:M([0,0,0],n)})}}}function N(t,n){let i=t.i._t[n],o=t.i.dt[n];i.vt&&o.gt.push(i.vt.slice()),i.X&&o.wt.push(i.X.slice())}function j(t,n){let i=t.i.yt[n];if(i.dt){let i=t.i.dt[n];t.xt.KeyW&&i.gt.push([0,0,1]),t.xt.KeyA&&i.gt.push([1,0,0]),t.xt.KeyS&&i.gt.push([0,0,-1]),t.xt.KeyD&&i.gt.push([-1,0,0])}if(i.Mt){let i=t.i.dt[n];t.xt.ArrowLeft&&i.wt.push([0,1,0,0]),t.xt.ArrowRight&&i.wt.push([0,-1,0,0])}if(i.Tt){let o=t.i.dt[n],e=P(t.i.T[n].X);t.xt.ArrowUp&&e>i.bt&&o.zt.push([-1,0,0,0]),t.xt.ArrowDown&&e<i.At&&o.zt.push([1,0,0,0])}}function U(t,n){let i=t.i.yt[n],o=t.i.T[n];if(i.Mt&&t.St.MouseX&&(C(ti,Zn,-t.St.MouseX*i.Mt*Xn),F(o.X,ti,o.X),o.V=!0),i.Tt&&t.St.MouseY){let n=P(o.X),e=f(i.bt-n,i.At-n,t.St.MouseY*i.Tt);C(ti,Qn,e*Xn),F(o.X,o.X,ti),o.V=!0}}function Y(t,n){let i=t.i.T[n],o=t.i.yt[n],e=t.i.dt[n];if(o.dt&&1===t.xt.Touch0){let n=Math.min(t.Ft,t.kt)/4,i=(t.xt.Touch0X-oi[0])/n,o=(t.xt.Touch0Y-oi[1])/n;Math.abs(i)>.01&&e.gt.push([f(-1,1,-i),0,0]),Math.abs(o)>.01&&e.gt.push([0,0,f(-1,1,-o)])}if(o.Mt&&t.St.Touch1X&&(C(ei,ni,-t.St.Touch1X*o.Mt*10*Xn),F(i.X,ei,i.X),i.V=!0),o.Tt&&t.St.Touch1Y){let n=P(i.X),e=f(o.bt-n,o.At-n,t.St.Touch1Y*o.Tt*10);C(ei,ii,e*Xn),F(i.X,i.X,ei),i.V=!0}}function O(t,n){let i=t.i.yt[n];if(i.dt){let i=t.i.dt[n];Math.abs(t.St.pad0_axis_1)>ai&&i.gt.push([-t.St.pad0_axis_1,0,0]),Math.abs(t.St.pad0_axis_2)>ai&&i.gt.push([0,0,-t.St.pad0_axis_2])}if(i.Mt&&Math.abs(t.St.pad0_axis_3)>ai&&t.i.dt[n].wt.push(C([0,0,0,0],ri,-t.St.pad0_axis_3*Math.PI)),i.Tt&&Math.abs(t.St.pad0_axis_4)>ai){let o=t.i.dt[n],e=t.St.pad0_axis_4*Math.PI,r=P(t.i.T[n].X);(e<0&&r>i.bt||e>0&&r<i.At)&&o.zt.push(C([0,0,0,0],li,e))}}function q(t,n){t.Pt.textAlign="center",t.Pt.font=n.Ct,t.Pt.fillStyle=n.Rt,t.Pt.fillText(n.Text,0,0)}function J(t,n){t.Pt.strokeStyle=n.Lt,t.Pt.strokeRect(-n.rt/2,-n.rt/2,n.rt,n.rt)}function Q(t,n,i){let r=t.i.It[n];r.Kt-=i,r.Kt<0&&(r.Vt&&e(t,r.Vt,n),o(t.i,n))}function Z(t,n,i){let o=t.i.Xt[n];v(fi,t.i.T[n].i),1===o.W&&T(fi,fi),t.Et[4*i+0]=fi[0],t.Et[4*i+1]=fi[1],t.Et[4*i+2]=fi[2],t.Et[4*i+3]=o.W,t.Dt[4*i+0]=o.Lt[0],t.Dt[4*i+1]=o.Lt[1],t.Dt[4*i+2]=o.Lt[2],t.Dt[4*i+3]=o.Bt}function tt(t,n,i){let o=t.i.T[n],e=t.i.dt[n];if(e.gt.length){let n=e.gt.reduce(nt),r=Math.min(1,function(t){return Math.hypot(t[0],t[1],t[2])}(n));A(n,n,o.i),void 0!==o.Ht&&A(n,n,t.i.T[o.Ht].$t),T(n,n),x(n,n,r*e.Gt*i),w(o.K,o.K,n),o.V=!0,e.gt=[]}if(e.wt.length){let t=e.wt.reduce(it);R(t,_i,t,Math.min(1,e.Wt/Math.PI*i)),F(o.X,t,o.X),o.V=!0,e.wt=[]}if(e.zt.length){let t=e.zt.reduce(it);R(t,_i,t,Math.min(1,e.Wt/Math.PI*i)),F(o.X,o.X,t),o.V=!0,e.zt=[]}}function nt(t,n){return w(t,t,n)}function it(t,n){return F(t,t,n)}function ot(t,n,i,o=0,e=[1,1,1,1],r=2304){return(l,a)=>{if(!mi.has(n)){let i=l.Nt.createVertexArray();l.Nt.bindVertexArray(i),l.Nt.bindBuffer(en,n.jt),l.Nt.enableVertexAttribArray(t.Yt.Ut),l.Nt.vertexAttribPointer(t.Yt.Ut,3,un,!1,0,0),l.Nt.bindBuffer(en,n.Ot),l.Nt.enableVertexAttribArray(t.Yt.qt),l.Nt.vertexAttribPointer(t.Yt.qt,3,un,!1,0,0),l.Nt.bindBuffer(rn,n.Jt),l.Nt.bindVertexArray(null),mi.set(n,i)}l.i.o[a]|=65536,l.i.Qt[a]={W:2,Zt:t,tn:n,nn:r,on:mi.get(n),en:i,rn:e,ln:o}}}function et(t,n,i,o=0,e=[1,1,1,1],r=2304){return(l,a)=>{if(!di.has(n)){let i=l.Nt.createVertexArray();l.Nt.bindVertexArray(i),l.Nt.bindBuffer(en,n.jt),l.Nt.enableVertexAttribArray(t.Yt.Ut),l.Nt.vertexAttribPointer(t.Yt.Ut,3,un,!1,0,0),l.Nt.bindBuffer(en,n.Ot),l.Nt.enableVertexAttribArray(t.Yt.qt),l.Nt.vertexAttribPointer(t.Yt.qt,3,un,!1,0,0),l.Nt.bindBuffer(en,n.an),l.Nt.enableVertexAttribArray(t.Yt.sn),l.Nt.vertexAttribPointer(t.Yt.sn,4,un,!1,0,0),l.Nt.bindBuffer(rn,n.Jt),l.Nt.bindVertexArray(null),di.set(n,i)}l.i.o[a]|=65536,l.i.Qt[a]={W:3,Zt:t,tn:n,nn:r,on:di.get(n),en:i,rn:e,ln:o}}}function rt(t,n,i,o){return(e,r)=>{let l=e.cn,a=e.Nt.createVertexArray();e.Nt.bindVertexArray(a),e.Nt.bindBuffer(en,t.jt),e.Nt.enableVertexAttribArray(l.Yt.Ut),e.Nt.vertexAttribPointer(l.Yt.Ut,3,un,!1,0,0),e.Nt.bindBuffer(en,t.Ot),e.Nt.enableVertexAttribArray(l.Yt.qt),e.Nt.vertexAttribPointer(l.Yt.qt,3,un,!1,0,0),e.Nt.bindBuffer(en,e.Nt.createBuffer()),e.Nt.bufferData(en,n,on),e.Nt.enableVertexAttribArray(l.Yt.fn),e.Nt.vertexAttribPointer(l.Yt.fn,4,un,!1,0,0),e.Nt.vertexAttribDivisor(l.Yt.fn,1),e.Nt.bindBuffer(en,e.Nt.createBuffer()),e.Nt.bufferData(en,i,on),e.Nt.enableVertexAttribArray(l.Yt.hn),e.Nt.vertexAttribPointer(l.Yt.hn,4,un,!1,0,0),e.Nt.vertexAttribDivisor(l.Yt.hn,1),e.Nt.bindBuffer(rn,t.Jt),e.Nt.bindVertexArray(null),e.i.o[r]|=65536,e.i.Qt[r]={W:11,Zt:l,tn:t,nn:ln,on:a,un:n.length/4,_n:o}}}function lt(t,n,i){let o=t.i.mn[n],e=t.i.T[n];o.dn+=i,o.dn>o.vn&&(o.dn=0,v(gi,e.i),d(pi,e.i),o.gn.push(...gi,0),o.gn.push(...pi,Math.random()));for(let t=0;t<o.gn.length;)o.gn[t+3]+=i,o.gn[t+3]>o.It?o.gn.splice(t,8):t+=8}function at(t,n,i){let o=t.i.T[n],e=t.i.pn[n];if(1===e.W){p(e.wn,e.yn),x(e.xn,e.xn,i),w(e.wn,e.wn,e.xn),e.wn[1]+=-9.81*i;let t=[0,0,0];x(t,e.wn,i),w(o.K,o.K,t),o.V=!0,(r=e.xn)[0]=0,r[1]=0,r[2]=0}var r}function st(t,n,i){let o=t.i.pn[n];if(2===o.W){let e=[0,0,0];v(e,t.i.T[n].i);let r=[0,0,0];y(r,e,o.Mn),x(o.wn,r,1/i),p(o.Mn,e)}}function ct(t,n){let i=t.i.T[n],o=t.i.Tn[n],e=t.i.pn[n];if(1===e.W){let n=!1;for(let r=0;r<o.ft.length;r++){let l=o.ft[r];if(131072&t.i.o[l.ht]){n=!0,w(i.K,i.K,l.ut),i.V=!0;let o=t.i.pn[l.ht];switch(o.W){case 0:T(Mi,l.ut),x(Mi,Mi,-2*b(e.wn,Mi)),w(e.yn,e.wn,Mi);break;case 1:case 2:p(e.yn,o.wn)}x(e.yn,e.yn,e.bn),l.ut[1]>0&&e.yn[1]<1&&(e.yn[1]=0)}}n||p(e.yn,e.wn)}}function ft(t,n){if(32&t.o[n]){let i=t.l[n];for(let n of i.l)if(1048576&t.o[n])return!0}return!1}function ht(t,n){t.Nt.bindFramebuffer(fn,n.zn.m),t.Nt.viewport(0,0,n.zn.v,n.zn.g),t.Nt.clearColor(...n.An),t.Nt.clear(16640),t.Nt.useProgram(t.Fn.Sn),t.Nt.uniformMatrix4fv(t.Fn.Yt.kn,!1,n.kn);let i=null;for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&bi)===bi){let o=t.i.T[n],e=t.i.Qt[n];switch(e.nn!==i&&(i=e.nn,t.Nt.frontFace(e.nn)),t.Nt.uniformMatrix4fv(t.Fn.Yt.i,!1,o.i),e.W){case 8:case 9:case 10:break;default:t.Nt.bindVertexArray(e.on),t.Nt.drawElements(t.Fn.Pn,e.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}}}function ut(t,n){t.Nt.bindFramebuffer(fn,null),t.Nt.viewport(0,0,t.Ft,t.kt),t.Nt.clearColor(...n.An),t.Nt.clear(16640),mt(t,n)}function _t(t,n){t.Nt.bindFramebuffer(fn,n.zn.m),t.Nt.viewport(0,0,n.zn.v,n.zn.g),t.Nt.clearColor(...n.An),t.Nt.clear(16640),mt(t,n,n.zn.Rn)}function mt(t,n,i){let o=null,e=null;for(let r=0;r<t.i.o.length;r++)if((t.i.o[r]&zi)===zi){let l=t.i.T[r],a=t.i.Qt[r];if(a.Zt!==o)switch(o=a.Zt,a.W){case 0:dt(t,a.Zt,n);break;case 1:gt(t,a.Zt,n);break;case 5:wt(t,a.Zt,n);break;case 6:xt(t,a.Zt,n);break;case 8:Tt(t,a.Zt,n);break;case 7:zt(t,a.Zt,n);break;case 2:St(t,a.Zt,n);break;case 3:kt(t,a.Zt,n);break;case 9:Ct(t,a.Zt,n);break;case 10:Lt(t,a.Zt,n);break;case 11:Kt(t,a.Zt,n)}switch(a.nn!==e&&(e=a.nn,t.Nt.frontFace(a.nn)),a.W){case 0:vt(t,l,a);break;case 1:pt(t,l,a);break;case 5:a.Ln!==i&&yt(t,l,a);break;case 6:a.Ln!==i&&Mt(t,l,a);break;case 8:bt(t,l,a);break;case 7:At(t,l,a);break;case 2:Ft(t,l,a);break;case 3:Pt(t,r,l,a);break;case 9:{let n=t.i.mn[r];n.gn.length&&Rt(t,a,n);break}case 10:{let n=t.i.mn[r];n.gn.length&&It(t,a,n);break}case 11:Vt(t,l,a)}}}function dt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn)}function vt(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniform4fv(i.Zt.Yt.Lt,i.Lt),t.Nt.bindVertexArray(i.on),t.Nt.drawElements(i.Zt.Pn,i.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function gt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn),t.Nt.uniform3fv(n.Yt.In,i.Kn),t.Nt.uniform4fv(n.Yt.Et,t.Et),t.Nt.uniform4fv(n.Yt.Dt,t.Dt)}function pt(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniformMatrix4fv(i.Zt.Yt.$t,!1,n.$t),t.Nt.uniform4fv(i.Zt.Yt.en,i.en),t.Nt.uniform4fv(i.Zt.Yt.rn,i.rn),t.Nt.uniform1f(i.Zt.Yt.ln,i.ln),t.Nt.bindVertexArray(i.on),t.Nt.drawElements(i.Zt.Pn,i.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function wt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn)}function yt(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.activeTexture(cn),t.Nt.bindTexture(sn,i.Ln),t.Nt.uniform1i(i.Zt.Yt.Vn,0),t.Nt.uniform4fv(i.Zt.Yt.Lt,i.Lt),t.Nt.bindVertexArray(i.on),t.Nt.drawElements(i.Zt.Pn,i.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function xt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn),t.Nt.uniform3fv(n.Yt.In,i.Kn),t.Nt.uniform4fv(n.Yt.Et,t.Et),t.Nt.uniform4fv(n.Yt.Dt,t.Dt)}function Mt(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniformMatrix4fv(i.Zt.Yt.$t,!1,n.$t),t.Nt.uniform4fv(i.Zt.Yt.en,i.en),t.Nt.uniform4fv(i.Zt.Yt.rn,i.rn),t.Nt.uniform1f(i.Zt.Yt.ln,i.ln),t.Nt.activeTexture(cn),t.Nt.bindTexture(sn,i.Ln),t.Nt.uniform1i(i.Zt.Yt.Xn,0),t.Nt.bindVertexArray(i.on),t.Nt.drawElements(i.Zt.Pn,i.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function Tt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn)}function bt(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniform4fv(i.Zt.Yt.Lt,i.Lt),t.Nt.bindBuffer(en,i.jt),t.Nt.enableVertexAttribArray(i.Zt.Yt.Ut),t.Nt.vertexAttribPointer(i.Zt.Yt.Ut,3,un,!1,0,0),t.Nt.drawArrays(i.Zt.Pn,0,i.Cn)}function zt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn),t.Nt.uniform3fv(n.Yt.In,i.Kn),t.Nt.uniform4fv(n.Yt.Et,t.Et),t.Nt.uniform4fv(n.Yt.Dt,t.Dt)}function At(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniformMatrix4fv(i.Zt.Yt.$t,!1,n.$t),t.Nt.uniform4fv(i.Zt.Yt.en,i.en),t.Nt.activeTexture(33985),t.Nt.bindTexture(sn,i.Xn),t.Nt.uniform1i(i.Zt.Yt.Xn,1),t.Nt.activeTexture(33986),t.Nt.bindTexture(sn,i.En),t.Nt.uniform1i(i.Zt.Yt.En,2),t.Nt.activeTexture(33987),t.Nt.bindTexture(sn,i.Dn),t.Nt.uniform1i(i.Zt.Yt.Dn,3),t.Nt.bindVertexArray(i.on),t.Nt.drawElements(i.Zt.Pn,i.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function St(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn),t.Nt.uniform3fv(n.Yt.In,i.Kn),t.Nt.uniform4fv(n.Yt.Et,t.Et),t.Nt.uniform4fv(n.Yt.Dt,t.Dt),t.Nt.activeTexture(cn),t.Nt.bindTexture(sn,t.Hn.Bn.M),t.Nt.uniform1i(n.Yt.$n,0);let o=function(t,n){for(let n=0;n<t.o.length;n++)if(4112==(4112&t.o[n]))return n}(t.i);o&&t.Nt.uniformMatrix4fv(n.Yt.Gn,!1,t.i.Wn[o].kn)}function Ft(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniformMatrix4fv(i.Zt.Yt.$t,!1,n.$t),t.Nt.uniform4fv(i.Zt.Yt.en,i.en),t.Nt.uniform4fv(i.Zt.Yt.rn,i.rn),t.Nt.uniform1f(i.Zt.Yt.ln,i.ln),t.Nt.bindVertexArray(i.on),t.Nt.drawElements(i.Zt.Pn,i.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function kt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn),t.Nt.uniform3fv(n.Yt.In,i.Kn),t.Nt.uniform4fv(n.Yt.Et,t.Et),t.Nt.uniform4fv(n.Yt.Dt,t.Dt)}function Pt(t,n,o,e){t.Nt.uniformMatrix4fv(e.Zt.Yt.i,!1,o.i),t.Nt.uniformMatrix4fv(e.Zt.Yt.$t,!1,o.$t),t.Nt.uniform4fv(e.Zt.Yt.en,e.en),t.Nt.uniform4fv(e.Zt.Yt.rn,e.rn),t.Nt.uniform1f(e.Zt.Yt.ln,e.ln);for(let o of i(t.i,n,4194312)){let n=t.i.T[o],i=t.i.Nn[o];_(Ai.subarray(16*i.jn),n.i,i.Un)}t.Nt.uniformMatrix4fv(e.Zt.Yt.Yn,!1,Ai),t.Nt.bindVertexArray(e.on),t.Nt.drawElements(e.Zt.Pn,e.tn.Cn,hn,0),t.Nt.bindVertexArray(null)}function Ct(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn)}function Rt(t,n,i){t.Nt.uniform4fv(n.Zt.Yt.On,n.On),t.Nt.uniform4fv(n.Zt.Yt.qn,n.qn),t.Nt.uniform4f(n.Zt.Yt.Jn,i.It,i.Qn,...n.rt);let o=Float32Array.from(i.gn);t.Nt.bindBuffer(en,n.N),t.Nt.bufferSubData(en,0,o),t.Nt.enableVertexAttribArray(n.Zt.Yt.Zn),t.Nt.vertexAttribPointer(n.Zt.Yt.Zn,4,un,!1,32,0),t.Nt.enableVertexAttribArray(n.Zt.Yt.vt),t.Nt.vertexAttribPointer(n.Zt.Yt.vt,3,un,!1,32,16),t.Nt.drawArrays(n.Zt.Pn,0,i.gn.length/8)}function Lt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn)}function It(t,n,i){t.Nt.uniform4fv(n.Zt.Yt.On,n.On),t.Nt.uniform4fv(n.Zt.Yt.qn,n.qn),t.Nt.activeTexture(cn),t.Nt.bindTexture(sn,n.Ln),t.Nt.uniform1i(n.Zt.Yt.Vn,0),t.Nt.uniform4f(n.Zt.Yt.Jn,i.It,i.Qn,...n.rt);let o=Float32Array.from(i.gn);t.Nt.bindBuffer(en,n.N),t.Nt.bufferSubData(en,0,o),t.Nt.enableVertexAttribArray(n.Zt.Yt.Zn),t.Nt.vertexAttribPointer(n.Zt.Yt.Zn,4,un,!1,32,0),t.Nt.enableVertexAttribArray(n.Zt.Yt.ti),t.Nt.vertexAttribPointer(n.Zt.Yt.ti,4,un,!1,32,16),t.Nt.drawArrays(n.Zt.Pn,0,i.gn.length/8)}function Kt(t,n,i){t.Nt.useProgram(n.Sn),t.Nt.uniformMatrix4fv(n.Yt.kn,!1,i.kn),t.Nt.uniform4fv(n.Yt.Et,t.Et),t.Nt.uniform4fv(n.Yt.Dt,t.Dt)}function Vt(t,n,i){t.Nt.uniformMatrix4fv(i.Zt.Yt.i,!1,n.i),t.Nt.uniformMatrix4fv(i.Zt.Yt.$t,!1,n.$t),t.Nt.uniform3fv(i.Zt.Yt._n,i._n),t.Nt.bindVertexArray(i.on),t.Nt.drawElementsInstanced(i.Zt.Pn,i.tn.Cn,hn,0,i.un),t.Nt.bindVertexArray(null)}function Xt(t,n){let i=t.i.ni[n],o=t.i.T[n];o.K=[Math.random()-.5,Math.random()-.5,Math.random()-.5],x(o.K,o.K,2*i.ii),o.V=!0}function Et(t=[0,0,0],n=[0,0,0,1],i=[1,1,1]){return(o,e)=>{o.i.o[e]|=4194304,o.i.T[e]={i:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$t:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K:t,X:n,D:i,V:!0}}}function Dt(n,i,o){let e=n.i.oi[i];if(e.dn+=o,e.dn>e.ei){e.dn=0;let o=n.i.T[i],r=[0,0,0];v(r,o.i);let l=[0,0,0,0];g(l,o.i),t(n,[...e.ri(n),Et(r,l)])}}function Bt(t,n,i){let o=t.i.li[n];o.dn+=i,o.dn>o.vn&&(o.dn=0,o.ai?(o.ai=!1,t.i.o[n]&=~o.si):(o.ai=!0,t.i.o[n]|=o.si))}function Ht(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Pi)===Pi){let i=t.i.T[n];i.V&&$t(t.i,n,i)}}function $t(t,n,i){if(i.V=!1,function(t,n,i,o){let e=n[0],r=n[1],l=n[2],a=n[3],s=e+e,c=r+r,f=l+l,h=e*s,u=e*c,_=e*f,m=r*c,d=r*f,v=l*f,g=a*s,p=a*c,w=a*f,y=o[0],x=o[1],M=o[2];t[0]=(1-(m+v))*y,t[1]=(u+w)*y,t[2]=(_-p)*y,t[3]=0,t[4]=(u-w)*x,t[5]=(1-(h+v))*x,t[6]=(d+g)*x,t[7]=0,t[8]=(_+p)*M,t[9]=(d-g)*M,t[10]=(1-(h+m))*M,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1}(i.i,i.X,i.K,i.D),void 0!==i.Ht&&_(i.i,t.T[i.Ht].i,i.i),u(i.$t,i.i),32&t.o[n]){let i=t.l[n];for(let o of i.l)if(4194304&t.o[o]){let i=t.T[o];i.Ht=n,$t(t,o,i)}}}function Gt(t,n){let i=t.i.Tn[n],o=t.i.S[n];for(let r of i.ft)o.si&t.i.Tn[r.ht].ct&&e(t,o.Vt,[n,r.ht])}function Wt(t,...n){return t.reduce(((t,i)=>t+function(t){let n=t.shift();return"boolean"==typeof n||null==n?"":Array.isArray(n)?n.join(""):n}(n)+i))}function Nt(t=0,n=1){return Ii=16807*Ii%2147483647,(Ii-1)/2147483646*(n-t)+t}function jt(t,n,i,o=[.9,.9,.9,1]){return(e,r)=>{e.i.o[r]|=16,e.i.Wn[r]={W:0,J:{W:0,Z:t,tt:n,nt:i,J:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],it:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},ci:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],kn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Kn:[0,0,0],An:o}}}function Ut(t,n,i,o,e=[0,0,0,1]){return(r,l)=>{r.i.o[l]|=16,r.i.Wn[l]={W:3,zn:t,J:{W:1,ot:n,tt:i,nt:o,J:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],it:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},ci:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],kn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Kn:[0,0,0],An:e}}}function Yt(t){return 1-(1-t)**4}function Ot(t){return t<.5?8*t**4:1-(-2*t+2)**4/2}function qt(t){return(n,i)=>{let o={};for(let n in t){let{R:i,C:e=7}=t[n],r=i[i.length-1].L;o[n]={R:i.map((t=>({...t}))),C:e,B:r,P:0}}n.i.o[i]|=1,n.i.A[i]={F:o,k:o.idle}}}function Jt(t,n){return(i,o)=>{i.i.o[o]|=8,i.i.Nn[o]={jn:t,V:void 0===n,Un:n||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}}}function Qt(t){return[et(t.fi,t.hi,[1,.3,0,1],128),n([Et([0,.63,0]),Jt(0,[1,0,0,0,0,1,0,0,0,0,1,0,0,-.63,0,1]),qt({idle:{R:[{L:1/0,K:[0,.63,0]}]},jump:{R:[{L:0,K:[0,.63,0]},{L:.2,K:[0,1.13,0],I:Ot},{L:.4,K:[0,.63,0],I:Yt}],C:0}}),n([Et([0,.72,0]),Jt(1,[1,0,0,0,0,1,0,0,0,0,1,0,0,-1.35,0,1]),qt({idle:{R:[{L:0,X:k([0,0,0,1],0,5,0)},{L:.5,X:k([0,0,0,1],0,-5,0)}]},walk:{R:[{L:0,X:k([0,0,0,1],0,5,0)},{L:.2,X:k([0,0,0,1],0,-5,0)}]},jump:{R:[{L:0,X:[0,0,0,1]},{L:.2,X:k([0,0,0,1],-15,0,0),I:Ot},{L:.4,X:k([0,0,0,1],0,0,0),I:Yt}],C:0}})],[Et([.3,.57,0],k([0,0,0,1],0,0,90)),Jt(2,[0,-1,0,0,1,0,0,0,0,0,1,0,-1.2,.3,0,1]),qt({idle:{R:[{L:0,X:k([0,0,0,1],5,0,0)},{L:.5,X:k([0,0,0,1],-5,0,0)}]},walk:{R:[{L:0,X:k([0,0,0,1],30,0,0)},{L:.2,X:k([0,0,0,1],-60,0,0)}]},jump:{R:[{L:0,X:[0,0,0,1]},{L:.2,X:k([0,0,0,1],0,0,135),I:Ot},{L:.4,X:[0,0,0,1],I:Yt}],C:0}})],[Et([-.3,.57,0],k([0,0,0,1],0,0,-90)),Jt(3,[0,1,0,0,-1,0,0,0,0,0,1,0,1.2,.3,0,1]),qt({idle:{R:[{L:0,X:k([0,0,0,1],-5,0,0)},{L:.5,X:k([0,0,0,1],5,0,0)}]},walk:{R:[{L:0,X:k([0,0,0,1],-60,0,0)},{L:.2,X:k([0,0,0,1],30,0,0)}]},jump:{R:[{L:0,X:[0,0,0,1]},{L:.2,X:k([0,0,0,1],0,0,-135),I:Ot},{L:.4,X:[0,0,0,1],I:Yt}],C:0}})],[Et([.15,0,0]),Jt(4,[1,0,0,0,0,1,0,0,0,0,1,0,-.15,-.63,0,1]),qt({idle:{R:[{L:0,X:k([0,0,0,1],5,0,0)},{L:1,X:k([0,0,0,1],5,0,0)}]},walk:{R:[{L:0,X:k([0,0,0,1],-45,0,0)},{L:.2,X:k([0,0,0,1],45,0,0)}]},jump:{R:[{L:0,X:[0,0,0,1]},{L:.2,X:k([0,0,0,1],0,0,45),I:Ot},{L:.4,X:[0,0,0,1],I:Yt}],C:0}})],[Et([-.15,0,0]),Jt(5,[1,0,0,0,0,1,0,0,0,0,1,0,.15,-.63,0,1]),qt({idle:{R:[{L:0,X:k([0,0,0,1],-5,0,0)},{L:1,X:k([0,0,0,1],-5,0,0)}]},walk:{R:[{L:0,X:k([0,0,0,1],45,0,0)},{L:.2,X:k([0,0,0,1],-45,0,0)}]},jump:{R:[{L:0,X:[0,0,0,1]},{L:.2,X:k([0,0,0,1],0,0,-45),I:Ot},{L:.4,X:[0,0,0,1],I:Yt}],C:0}})])])]}function Zt(t,n){return(i,o)=>{i.i.o[o]|=128,i.i._t[o]={vt:t,X:n}}}function tn(t=[1,1,1],n=1){return(i,o)=>{i.i.o[o]|=4096,i.i.Xt[o]={W:1,Lt:t,Bt:n**2}}}function nn(t){return[Zt(null,[0,1,0,0]),(t,n)=>{t.i.o[n]|=16384,t.i.dt[n]={Gt:0,Wt:1.5,gt:[],wt:[],zt:[]}},n([Et([0,0,10]),tn([1,1,1],.9),Ut(t.Hn.Bn,10,1,100)])]}const on=35044,en=34962,rn=34963,ln=2304,an=9729,sn=3553,cn=33984,fn=36160,hn=5123,un=5126,_n=document.getElementById("update"),mn=document.getElementById("delta"),dn=document.getElementById("fps"),vn=1/60;let gn=Float32Array.from([-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]),pn=Float32Array.from([-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0]),wn=Float32Array.from([.666667,.333333,.333333,.333333,.333333,0,.666667,0,.333333,.666667,0,.666667,0,.333333,.333333,.333333,.333333,.333333,0,.333333,0,0,.333333,0,.333333,.666667,.333333,.333333,.666667,.333333,.666667,.666667,1,.333333,.666667,.333333,.666667,0,1,0,.333333,.666667,.333333,1,0,1,0,.666667]),yn=Float32Array.from([]),xn=Uint16Array.from([23,22,20,22,21,20,19,18,16,18,17,16,15,14,12,14,13,12,11,10,8,10,9,8,7,6,4,6,5,4,3,2,0,2,1,0]),Mn=Float32Array.from([.040103,0,.044704,-.054562,0,-.050619,-.124883,.01643,.126198,.040103,0,.044704,.12554,.021688,-.126198,-.054562,0,-.050619]),Tn=Float32Array.from([.0665,.9956,-.0661,.0665,.9956,-.0661,.0665,.9956,-.0661,-.0844,.9929,.0838,-.0844,.9929,.0838,-.0844,.9929,.0838]),bn=Float32Array.from([1,0,0,1,0,0,1,0,1,1,0,1]),zn=Float32Array.from([]),An=Uint16Array.from([5,4,3,2,1,0]),Sn=Float32Array.from([-.3,1.2,-.15,.45,1.47,0,.3,1.2,-.15,.27,.63,0,0,.63,.15,.15,0,0,.3,1.2,.15,1.05,1.35,0,-1.05,1.35,0,-.45,1.47,0,-.3,1.2,.15,0,.63,-.15,-.15,0,0,-.27,.63,0,0,2.25,-.15,0,2.25,.45]),Fn=Float32Array.from([-.424,-.0402,-.9048,.3556,.9341,-.0314,.424,-.0402,-.9048,.9544,-.2985,0,0,-.2684,.9633,.0912,-.9958,0,.424,-.0402,.9048,.9979,.0645,0,-.9979,.0645,0,-.3556,.9341,-.0314,-.424,-.0402,.9048,0,-.2684,-.9633,-.0912,-.9958,0,-.9544,-.2985,0,0,.767,-.6416,0,.6255,.7802]),kn=Float32Array.from([]),Pn=Float32Array.from([3,1,0,0,1,.75,2,.25,2,1,0,0,4,1,0,0,4,.5,5,.5,4,1,0,0,2,1,0,0,2,1,0,0,3,1,0,0,1,.75,3,.25,3,1,0,0,4,.5,5,.5,5,1,0,0,5,1,0,0,1,1,0,0,1,1,0,0]),Cn=Uint16Array.from([15,9,14,1,15,14,9,15,1,1,14,9,2,7,1,9,1,6,6,7,2,7,6,1,6,2,3,6,3,4,5,4,3,11,3,2,4,5,11,4,11,12,11,5,3,12,13,4,13,12,11,10,6,4,10,4,13,6,10,9,8,9,10,0,11,2,0,13,11,1,9,0,10,0,8,0,10,13,9,8,0,2,1,0]),Rn=Float32Array.from([.5,0,.5,-.5,0,-.5,-.5,0,.5,.5,0,-.5]),Ln=Float32Array.from([0,1,0,0,1,0,0,1,0,0,1,0]),In=Float32Array.from([1,0,0,1,0,0,1,1]),Kn=Float32Array.from([]),Vn=Uint16Array.from([1,3,0,2,1,0]);const Xn=Math.PI/180,En=4194305,Dn=4194306;let Bn,Hn=[0,0,0],$n=[0,0,0],Gn=[0,0,0];const Wn=4194308,Nn=[0,0,0],jn=[0,0,0],Un=4194320,Yn=[[.5,.5,.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,-.5,.5]],On=4194368,qn=4210816,Jn=4210944,Qn=[1,0,0],Zn=[0,1,0],ti=[0,0,0,0],ni=[0,1,0],ii=[1,0,0],oi=[0,0],ei=[0,0,0,0],ri=[0,1,0],li=[1,0,0],ai=.1,si=4194816,ci=4198400;let fi=[0,0,0];const hi=4202496,ui=4210688,_i=[0,0,0,1],mi=new WeakMap,di=new WeakMap,vi=4195328;let gi=[0,0,0],pi=[0,0,0];const wi=4325376,yi=4325376,xi=4325440;let Mi=[0,0,0];const Ti=1048576,bi=4259840,zi=4259840,Ai=new Float32Array(96),Si=4456448,Fi=4718592,ki=2097152,Pi=4194304,Ci=12582976;let Ri;class Li extends class{constructor(){this.o=[],this.ui=[]}t(){return this.ui.length>0?this.ui.pop():this.o.push(0)-1}h(t){this.o[t]=0,this.ui.push(t)}}{constructor(){super(...arguments),this.A=[],this.H=[],this.Nn=[],this.Wn=[],this.l=[],this.Tn=[],this._t=[],this.yt=[],this._i=[],this.mn=[],this.It=[],this.Xt=[],this.mi=[],this.dt=[],this.di=[],this.Qt=[],this.pn=[],this.ni=[],this.oi=[],this.vi=[],this.li=[],this.T=[],this.S=[]}}let Ii=1,Ki=new class extends class extends class{constructor(){this.gi=0,this.pi=0,this.Ft=window.innerWidth,this.kt=window.innerHeight,this.wi=!0,this.xt={MouseX:0,MouseY:0},this.St={MouseX:0,MouseY:0},this.yi={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.xi={},this.Mi=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.Ti():this.bi())),this.Mi.addEventListener("contextmenu",(t=>t.preventDefault())),this.Mi.addEventListener("mousedown",(t=>{this.xt["Mouse"+t.button]=1,this.St["Mouse"+t.button]=1})),this.Mi.addEventListener("mouseup",(t=>{this.xt["Mouse"+t.button]=0,this.St["Mouse"+t.button]=-1})),this.Mi.addEventListener("mousemove",(t=>{this.xt.MouseX=t.clientX,this.xt.MouseY=t.clientY,this.St.MouseX=t.movementX,this.St.MouseY=t.movementY})),this.Mi.addEventListener("wheel",(t=>{t.preventDefault(),this.St.WheelY=t.deltaY})),this.Mi.addEventListener("touchstart",(t=>{t.preventDefault(),1===t.touches.length&&(this.xi={});for(let n=0;n<t.touches.length;n++)this.xi[t.touches[n].identifier]=n;for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],o=this.xi[i.identifier];this.xt["Touch"+o]=1,this.xt[`Touch${o}X`]=i.clientX,this.xt[`Touch${o}Y`]=i.clientY,this.St["Touch"+o]=1,this.St[`Touch${o}X`]=0,this.St[`Touch${o}Y`]=0}})),this.Mi.addEventListener("touchmove",(t=>{t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],o=this.xi[i.identifier];this.St[`Touch${o}X`]=i.clientX-this.xt[`Touch${o}X`],this.St[`Touch${o}Y`]=i.clientY-this.xt[`Touch${o}Y`],this.xt[`Touch${o}X`]=i.clientX,this.xt[`Touch${o}Y`]=i.clientY}})),this.Mi.addEventListener("touchend",(t=>{t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=this.xi[t.changedTouches[n].identifier];this.xt["Touch"+i]=0,this.St["Touch"+i]=-1}})),this.Mi.addEventListener("touchcancel",(t=>{t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=this.xi[t.changedTouches[n].identifier];this.xt["Touch"+i]=0,this.St["Touch"+i]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.xt[t.code]=1,this.St[t.code]=1)})),window.addEventListener("keyup",(t=>{this.xt[t.code]=0,this.St[t.code]=-1}))}bi(){let t=0,n=performance.now(),i=o=>{let e=(o-n)/1e3;for(this.zi(e),t+=e;t>=vn;)t-=vn,this.Ai(vn);this.Si(e),this.Fi(e),n=o,this.gi=requestAnimationFrame(i)};this.Ti(),i(n)}Ti(){cancelAnimationFrame(this.gi),this.gi=0}zi(t){this.pi=performance.now();let n=Math.abs(this.St.MouseX)+Math.abs(this.St.MouseY);this.yi.Mouse+=n,1===this.xt.Mouse0&&(this.yi.Mouse0+=n),1===this.xt.Mouse1&&(this.yi.Mouse1+=n),1===this.xt.Mouse2&&(this.yi.Mouse2+=n),1===this.xt.Touch0&&(this.yi.Touch0+=Math.abs(this.St.Touch0X)+Math.abs(this.St.Touch0Y)),1===this.xt.Touch1&&(this.yi.Touch1+=Math.abs(this.St.Touch1X)+Math.abs(this.St.Touch1Y))}Ai(t){}Si(t){}Fi(t){this.wi=!1,-1===this.St.Mouse0&&(this.yi.Mouse0=0),-1===this.St.Mouse1&&(this.yi.Mouse1=0),-1===this.St.Mouse2&&(this.yi.Mouse2=0),-1===this.St.Touch0&&(this.yi.Touch0=0),-1===this.St.Touch1&&(this.yi.Touch1=0);for(let t in this.St)this.St[t]=0;let n=performance.now()-this.pi;_n&&(_n.textContent=n.toFixed(1)),mn&&(mn.textContent=(1e3*t).toFixed(1)),dn&&(dn.textContent=(1/t).toFixed())}}{constructor(){super(),this.ki=document.querySelector("#billboard"),this.Pt=this.ki.getContext("2d"),this.Pi=document.querySelector("#scene"),this.Nt=this.Pi.getContext("webgl2"),this.Audio=new AudioContext,this.Nt.enable(2929),this.Nt.enable(2884)}}{constructor(){super(...arguments),this.i=new Li,this.Ci=function(t){let n=s(t,"#version 300 es\n\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nin vec3 attr_position;\nin vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * vec4(attr_position, 1.0);\nvert_normal = (vec4(attr_normal, 1.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform float shininess;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = diffuse_color.rgb * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += diffuse_color.rgb * diffuse_factor * light_color * light_intensity;\n\nif (shininess > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, shininess);\n\n\nlight_acc += specular_color.rgb * specular_factor * light_color * light_intensity;\n}\n}\n}\n\nfrag_color = vec4(light_acc, 1.0);\n}\n");return{Pn:4,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),$t:t.getUniformLocation(n,"self"),en:t.getUniformLocation(n,"diffuse_color"),rn:t.getUniformLocation(n,"specular_color"),ln:t.getUniformLocation(n,"shininess"),In:t.getUniformLocation(n,"eye"),Et:t.getUniformLocation(n,"light_positions"),Dt:t.getUniformLocation(n,"light_details"),Ut:t.getAttribLocation(n,"attr_position"),qt:t.getAttribLocation(n,"attr_normal")}}}(this.Nt),this.Ri=function(t){let n=s(t,"#version 300 es\n\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nin vec3 attr_position;\nin vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * vec4(attr_position, 1.0);\nvert_normal = (vec4(attr_normal, 1.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\nprecision lowp sampler2DShadow;\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform float shininess;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\nuniform mat4 shadow_space;\nuniform sampler2DShadow shadow_map;\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\n\n\nfloat shadow_factor(vec4 world_pos, float min) {\nvec4 shadow_space_pos = shadow_space * world_pos;\nvec3 shadow_space_ndc = shadow_space_pos.xyz / shadow_space_pos.w;\n\nshadow_space_ndc = shadow_space_ndc * 0.5 + 0.5;\n\n\nshadow_space_ndc.z -= 0.001;\n\nreturn texture(shadow_map, shadow_space_ndc) * (1.0 - min) + min;\n}\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = diffuse_color.rgb * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += diffuse_color.rgb * diffuse_factor * light_color * light_intensity;\n\nif (shininess > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, shininess);\n\n\nlight_acc += specular_color.rgb * specular_factor * light_color * light_intensity;\n}\n}\n}\n\nvec3 shaded_rgb = light_acc * shadow_factor(vert_position, 0.5);\nfrag_color= vec4(shaded_rgb, 1.0);\n}\n");return{Pn:4,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),$t:t.getUniformLocation(n,"self"),en:t.getUniformLocation(n,"diffuse_color"),rn:t.getUniformLocation(n,"specular_color"),ln:t.getUniformLocation(n,"shininess"),In:t.getUniformLocation(n,"eye"),Et:t.getUniformLocation(n,"light_positions"),Dt:t.getUniformLocation(n,"light_details"),Gn:t.getUniformLocation(n,"shadow_space"),$n:t.getUniformLocation(n,"shadow_map"),Ut:t.getAttribLocation(n,"attr_position"),qt:t.getAttribLocation(n,"attr_normal")}}}(this.Nt),this.Li=function(t){let n=s(t,"#version 300 es\n\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform float shininess;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\nuniform mat4 bones[6];\n\nin vec3 attr_position;\nin vec3 attr_normal;\nin vec4 attr_weights;\n\nout vec4 vert_color;\n\nmat4 world_weighted(vec4 weights) {\nreturn weights[1] * bones[int(weights[0])] + weights[3] * bones[int(weights[2])];\n}\n\nvoid main() {\nmat4 bone_world = world_weighted(attr_weights);\nvec4 world_position = bone_world * vec4(attr_position, 1.0);\nvec3 world_normal = normalize(mat3(bone_world) * attr_normal);\ngl_Position = pv * world_position;\n\nvec3 view_dir = eye - world_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = diffuse_color.rgb * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - world_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += diffuse_color.rgb * diffuse_factor * light_color * light_intensity;\n\nif (shininess > 0.0) {\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, shininess);\n\n\nlight_acc += specular_color.rgb * specular_factor * light_color * light_intensity;\n}\n}\n}\n\nvert_color = vec4(light_acc, 1.0);\n}\n","#version 300 es\n\nprecision mediump float;\n\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color;\n}\n");return{Pn:4,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),$t:t.getUniformLocation(n,"self"),en:t.getUniformLocation(n,"diffuse_color"),rn:t.getUniformLocation(n,"specular_color"),ln:t.getUniformLocation(n,"shininess"),In:t.getUniformLocation(n,"eye"),Et:t.getUniformLocation(n,"light_positions"),Dt:t.getUniformLocation(n,"light_details"),Ut:t.getAttribLocation(n,"attr_position"),qt:t.getAttribLocation(n,"attr_normal"),Yn:t.getUniformLocation(n,"bones"),sn:t.getAttribLocation(n,"attr_weights")}}}(this.Nt),this.fi=function(t){let n=s(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\nuniform mat4 bones[6];\n\nin vec3 attr_position;\nin vec3 attr_normal;\nin vec4 attr_weights;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nmat4 world_weighted(vec4 weights) {\nreturn weights[1] * bones[int(weights[0])] + weights[3] * bones[int(weights[2])];\n}\n\nvoid main() {\nmat4 bone_world = world_weighted(attr_weights);\nvert_position = bone_world * vec4(attr_position, 1.0);\nvert_normal = normalize(mat3(bone_world) * attr_normal);\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform float shininess;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = diffuse_color.rgb * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += diffuse_color.rgb * diffuse_factor * light_color * light_intensity;\n\nif (shininess > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, shininess);\n\n\nlight_acc += specular_color.rgb * specular_factor * light_color * light_intensity;\n}\n}\n}\n\nfrag_color = vec4(light_acc, 1.0);\n}\n");return{Pn:4,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),$t:t.getUniformLocation(n,"self"),en:t.getUniformLocation(n,"diffuse_color"),rn:t.getUniformLocation(n,"specular_color"),ln:t.getUniformLocation(n,"shininess"),In:t.getUniformLocation(n,"eye"),Et:t.getUniformLocation(n,"light_positions"),Dt:t.getUniformLocation(n,"light_details"),Ut:t.getAttribLocation(n,"attr_position"),qt:t.getAttribLocation(n,"attr_normal"),Yn:t.getUniformLocation(n,"bones"),sn:t.getAttribLocation(n,"attr_weights")}}}(this.Nt),this.Ii=function(t){let n=s(t,"#version 300 es\n\nuniform mat4 pv;\nuniform vec4 color_start;\nuniform vec4 color_end;\n\nuniform vec4 details;\n\n\nin vec4 attr_origin_age;\nin vec3 attr_direction;\n\nout vec4 vert_color;\n\nvoid main() {\n\nvec3 velocity = attr_direction * details.y;\ngl_Position = pv * vec4(attr_origin_age.xyz + velocity * attr_origin_age.w, 1.0);\n\n\nfloat t = attr_origin_age.w / details.x;\ngl_PointSize = mix(details.z, details.w, t);\nvert_color = mix(color_start, color_end, t);\n}\n","#version 300 es\n\nprecision mediump float;\n\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color;\n}\n");return{Pn:0,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),On:t.getUniformLocation(n,"color_start"),qn:t.getUniformLocation(n,"color_end"),Jn:t.getUniformLocation(n,"details"),Zn:t.getAttribLocation(n,"attr_origin_age"),vt:t.getAttribLocation(n,"attr_direction")}}}(this.Nt),this.Ki=function(t){let n=s(t,"#version 300 es\n\nuniform mat4 pv;\nuniform vec4 color_start;\nuniform vec4 color_end;\n\nuniform vec4 details;\n\n\nin vec4 attr_origin_age;\n\nin vec4 attr_direction_seed;\n\nout vec4 vert_color;\nout float vert_rand;\n\nvoid main() {\n\nvec3 velocity = attr_direction_seed.xyz * details.y;\ngl_Position = pv * vec4(attr_origin_age.xyz + velocity * attr_origin_age.w, 1.0);\n\n\nfloat t = attr_origin_age.w / details.x;\ngl_PointSize = mix(details.z, details.w, t);\nvert_color = mix(color_start, color_end, t);\n\n\nvert_rand = 3.14 * t + attr_direction_seed.w;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform sampler2D texture_map;\n\nin vec4 vert_color;\nin float vert_rand;\n\nout vec4 frag_color;\n\nvoid main() {\n\nvec2 uv = gl_PointCoord + floor(vec2(cos(vert_rand) + 0.5, sin(vert_rand) + 0.5));\nfrag_color = vert_color * texture(texture_map, uv / 2.0);\n}\n");return{Pn:0,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),Vn:t.getUniformLocation(n,"texture_map"),On:t.getUniformLocation(n,"color_start"),qn:t.getUniformLocation(n,"color_end"),Jn:t.getUniformLocation(n,"details"),Zn:t.getAttribLocation(n,"attr_origin_age"),ti:t.getAttribLocation(n,"attr_direction_seed")}}}(this.Nt),this.Fn=function(t){let n=s(t,"#version 300 es\n\n\nuniform mat4 pv;\nuniform mat4 world;\n\nin vec3 attr_position;\n\nvoid main() {\ngl_Position = pv * world * vec4(attr_position, 1.0);\n}\n","#version 300 es\n\nprecision mediump float;\n\nout vec4 frag_color;\n\nvoid main() {\n\nfloat z = gl_FragCoord.z * 10.0;\nfrag_color = vec4(z, z, z, 1.0);\n}\n");return{Pn:4,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),Ut:t.getAttribLocation(n,"attr_position")}}}(this.Nt),this.cn=function(t){let n=s(t,"#version 300 es\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\nuniform vec3 palette[16];\n\nuniform int light_count;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\n\nin vec3 attr_position;\nin vec3 attr_normal;\nin vec4 attr_offset;\nin vec4 attr_offset_rotation;\n\nout vec4 vert_color;\n\nvoid main() {\nfloat x = attr_offset_rotation.x;\nfloat y = attr_offset_rotation.y;\nfloat z = attr_offset_rotation.z;\nfloat w = attr_offset_rotation.w;\n\nfloat x2 = x + x;\nfloat y2 = y + y;\nfloat z2 = z + z;\nfloat xx = x * x2;\nfloat yx = y * x2;\nfloat yy = y * y2;\nfloat zx = z * x2;\nfloat zy = z * y2;\nfloat zz = z * z2;\nfloat wx = w * x2;\nfloat wy = w * y2;\nfloat wz = w * z2;\n\nfloat m0 = 1.0 - yy - zz;\nfloat m1 = yx + wz;\nfloat m2 = zx - wy;\nfloat m3 = 0.0;\nfloat m4 = yx - wz;\nfloat m5 = 1.0 - xx - zz;\nfloat m6 = zy + wx;\nfloat m7 = 0.0;\nfloat m8 = zx + wy;\nfloat m9 = zy - wx;\nfloat m10 = 1.0 - xx - yy;\nfloat m11 = 0.0;\nfloat m12 = 0.0;\nfloat m13 = 0.0;\nfloat m14 = 0.0;\nfloat m15 = 1.0;\n\nmat4 rotation = mat4(\nm0, m1, m2, m3,\nm4, m5, m6, m7,\nm8, m9, m10, m11,\nm12, m13, m14, m15\n);\n\nvec4 world_position = world * rotation * vec4(attr_position + attr_offset.xyz, 1.0);\nvec3 world_normal = normalize((rotation * vec4(attr_normal, 0.0) * self).xyz);\ngl_Position = pv * world_position;\n\n\nvec3 color = palette[int(attr_offset[3])];\nvec3 light_acc = color * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - world_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += color * diffuse_factor * light_color * light_intensity;\n}\n}\n\nvert_color = vec4(light_acc, 1.0);\n}\n\n","#version 300 es\n\nprecision mediump float;\nin vec4 vert_color;\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color;\n}\n\n");return{Pn:4,Sn:n,Yt:{kn:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),$t:t.getUniformLocation(n,"self"),_n:t.getUniformLocation(n,"palette"),Et:t.getUniformLocation(n,"light_positions"),Dt:t.getUniformLocation(n,"light_details"),Ut:t.getAttribLocation(n,"attr_position"),qt:t.getAttribLocation(n,"attr_normal"),fn:t.getAttribLocation(n,"attr_offset"),hn:t.getAttribLocation(n,"attr_offset_rotation")}}}(this.Nt),this.Vi=function(t){let n=t.createBuffer();t.bindBuffer(en,n),t.bufferData(en,Mn,on);let i=t.createBuffer();t.bindBuffer(en,i),t.bufferData(en,Tn,on);let o=t.createBuffer();t.bindBuffer(en,o),t.bufferData(en,bn,on);let e=t.createBuffer();t.bindBuffer(en,e),t.bufferData(en,zn,on);let r=t.createBuffer();return t.bindBuffer(rn,r),t.bufferData(rn,An,on),{jt:n,Xi:Mn,Ot:i,Ei:Tn,Di:o,Bi:bn,an:e,Hi:zn,Jt:r,$i:An,Cn:An.length}}(this.Nt),this.Gi=function(t){let n=t.createBuffer();t.bindBuffer(en,n),t.bufferData(en,Rn,on);let i=t.createBuffer();t.bindBuffer(en,i),t.bufferData(en,Ln,on);let o=t.createBuffer();t.bindBuffer(en,o),t.bufferData(en,In,on);let e=t.createBuffer();t.bindBuffer(en,e),t.bufferData(en,Kn,on);let r=t.createBuffer();return t.bindBuffer(rn,r),t.bufferData(rn,Vn,on),{jt:n,Xi:Rn,Ot:i,Ei:Ln,Di:o,Bi:In,an:e,Hi:Kn,Jt:r,$i:Vn,Cn:Vn.length}}(this.Nt),this.Wi=function(t){let n=t.createBuffer();t.bindBuffer(en,n),t.bufferData(en,gn,on);let i=t.createBuffer();t.bindBuffer(en,i),t.bufferData(en,pn,on);let o=t.createBuffer();t.bindBuffer(en,o),t.bufferData(en,wn,on);let e=t.createBuffer();t.bindBuffer(en,e),t.bufferData(en,yn,on);let r=t.createBuffer();return t.bindBuffer(rn,r),t.bufferData(rn,xn,on),{jt:n,Xi:gn,Ot:i,Ei:pn,Di:o,Bi:wn,an:e,Hi:yn,Jt:r,$i:xn,Cn:xn.length}}(this.Nt),this.hi=function(t){let n=t.createBuffer();t.bindBuffer(en,n),t.bufferData(en,Sn,on);let i=t.createBuffer();t.bindBuffer(en,i),t.bufferData(en,Fn,on);let o=t.createBuffer();t.bindBuffer(en,o),t.bufferData(en,kn,on);let e=t.createBuffer();t.bindBuffer(en,e),t.bufferData(en,Pn,on);let r=t.createBuffer();return t.bindBuffer(rn,r),t.bufferData(rn,Cn,on),{jt:n,Xi:Sn,Ot:i,Ei:Fn,Di:o,Bi:kn,an:e,Hi:Pn,Jt:r,$i:Cn,Cn:Cn.length}}(this.Nt),this.Et=new Float32Array(32),this.Dt=new Float32Array(32),this.Ni=[],this.Hn={Bn:a(this.Nt,2048,2048)},this.u=0,this._=0}Ai(t){!function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&wi)===wi&&at(t,i,n)}(this,t),Ht(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&yi)===yi&&st(t,i,n)}(this,t),function(t,n){let i=[],o=[];for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&On)===On){let e=t.i.T[n],r=t.i.Tn[n];r.ft=[],r.ji?(r.ji=!1,H(e.i,r)):r.Ui?(H(e.i,r),o.push(r)):i.push(r)}for(let t=0;t<o.length;t++)W(o[t],i,i.length),W(o[t],o,t)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&xi)===xi&&ct(t,n)}(this),Ht(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Ci)===Ci&&Gt(t,n)}(this)}Si(t){!function(t,n){let i=[];for(let o=0;o<t.i.o.length;o++)if((t.i.o[o]&Ti)===Ti){if(ft(t.i,o))continue;let e=t.i.vi[o];switch(e.W){case 0:e.Yi(o)&&i.push(o);break;case 1:e.Kt-=n,e.Kt<0&&i.push(o)}}for(let n of i){t.i.o[n]&=-1048577,0===t.i.o[n]&&t.i.h(n);let i=t.i.vi[n];i.Oi&&i.Oi(n),delete t.i.vi[n]}}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)16640==(16640&t.i.o[n])&&j(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Jn)===Jn&&U(t,n)}(this),function(t,n){1===t.St.Touch0&&(oi[0]=t.xt.Touch0X,oi[1]=t.xt.Touch0Y);for(let n=0;n<t.i.o.length;n++)16640==(16640&t.i.o[n])&&Y(t,n)}(this),function(t,n){for(let n of navigator.getGamepads())n&&(t.St[`pad${n.index}_axis_1`]=n.axes[0],t.St[`pad${n.index}_axis_2`]=n.axes[1],t.St[`pad${n.index}_axis_3`]=n.axes[2],t.St[`pad${n.index}_axis_4`]=n.axes[3]);for(let n=0;n<t.i.o.length;n++)16640==(16640&t.i.o[n])&&O(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&qn)===qn&&N(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&En)===En&&L(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&ui)===ui&&tt(t,i,n)}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&hi)===hi){let i=t.i.T[n],o=t.i.mi[n],e=t.i.T[o.zn],r=v([0,0,0],e.i),l=g([0,0,0,0],e.i);S(i.K,i.K,r,o.qi),R(i.X,i.X,l,o.qi),i.V=!0}}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)2048==(2048&t.i.o[i])&&Q(t,i,n)}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Si)==Si&&Xt(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&ki)==ki&&Bt(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Fi)==Fi&&Dt(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&vi)==vi&&lt(t,i,n)}(this,t),Ht(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Dn)===Dn&&I(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Wn)===Wn&&X(t,i,n)}(this,t),function(t,n){t.Ft==window.innerWidth&&t.kt==window.innerHeight||(t.wi=!0),t.wi&&(t.Ft=t.Pi.width=t.ki.width=window.innerWidth,t.kt=t.Pi.height=t.ki.height=window.innerHeight)}(this),function(t,n){t.Ni=[];for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Un)===Un){let i=t.i.Wn[n],o=t.i.T[n],e=i.J;if(t.wi)switch(e.W){case 0:D(e,0===i.W?t.Ft/t.kt:i.zn.v/i.zn.g);break;case 1:B(e)}h(i.ci,o.$t),_(i.kn,e.J,i.ci),v(i.Kn,o.i),t.Ni.push(n)}}(this),function(t,n){t.Et.fill(0),t.Dt.fill(0);let i=0;for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&ci)===ci&&Z(t,n,i++)}(this),function(t,n){for(let n of t.Ni){let i=t.i.Wn[n];switch(i.W){case 3:ht(t,i)}}}(this),function(t,n){for(let n of t.Ni){let i=t.i.Wn[n];switch(i.W){case 0:ut(t,i);break;case 2:_t(t,i)}}}(this),function(t,n){t.Pt.resetTransform(),t.Pt.clearRect(0,0,t.Ft,t.kt);let i=[0,0,0],o=t.i.Wn[t.Ni[0]];if(o)for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&si)==si){if(v(i,t.i.T[n].i),z(i,i,o.kn),i[2]<-1||i[2]>1)continue;t.Pt.setTransform(1,0,0,1,.5*(i[0]+1)*t.Ft,.5*(1-i[1])*t.kt);let e=t.i._i[n];switch(e.W){case 0:q(t,e);break;case 2:J(t,e)}}}(this),function(t,n){let i=function(t){return Wt`<div>${Wt`
<div
style="
position: absolute;
top: 1vmin;
left: 1vmin;
background: #000;
color: #fff;
font: 13px Arial;
"
>
<button
onclick="$(${0})"
style="
padding: 1vmin;
background: #000;
color: #fff;
border: none;
"
>
${document.fullscreenElement?"Exit Fullscreen":"Enter Fullscreen"}
</button>
</div>
`} ${function(t){return Wt`
<div
style="
position: absolute;
right: 0;
bottom: 0;
left: 0;
height: 10vmin;

display: flex;
justify-content: space-around;
align-items: center;

background: rgba(0, 0, 0, 0.5);
color: #fff;
font: 24px Impact;
font-style: italic;
"
>
<div>Collected: ${t.u}</div>
<div>Missed: ${t._}</div>
</div>
`}(t)}</div>`}(t);i!==Ri&&(t.Mi.innerHTML=Ri=i)}(this)}};!function(t){t.Mi.addEventListener("click",(()=>t.Mi.requestPointerLock()))}(Ki),function(i){i.i=new Li,i.wi=!0,t(i,[n([Et(void 0,[0,1,0,0]),jt(1,.1,1e3)]),Et([0,2,5],[0,1,0,0])]),t(i,[Et(void 0,k([0,0,0,0],-45,45,0)),...nn(i)]),t(i,[Et(void 0,void 0,[10,1,10]),ot(i.Ri,i.Wi,[1,1,0,1])]);let o=[],e=[];for(let t=0;t<200;t++)o.push(Nt(-.8,.8),Nt(-.8,.8),Nt(-.8,.8),0),e.push(...k([0,0,0,0],Nt(-90,90),Nt(-90,90),Nt(-90,90)));var r,l;t(i,[Et([-1,2,-2],k([0,0,0,0],67,0,0)),rt(i.Vi,Float32Array.from(o),Float32Array.from(e),[0,1,0])]),t(i,[...Qt(i),Et([1,.5,0])]),t(i,[n([Et(void 0,k([0,0,0,0],-90,0,0)),(t,n)=>{t.i.o[n]|=1024,t.i.mn[n]={It:1,vn:.05,Qn:5,gn:[],dn:0}},(r=[1,1,0,1],l=[1,0,0,1],(t,n)=>{let i=t.Nt.createBuffer();t.Nt.bindBuffer(en,i),t.Nt.bufferData(en,6400,35048),t.i.o[n]|=65536,t.i.Qt[n]={W:9,Zt:t.Ii,N:i,On:r,qn:l,rt:[20,5],nn:ln}}),(t,n)=>{t.i.o[n]|=262144,t.i.ni[n]={ii:1}}]),Et([0,.5,-3])])}(Ki),Ki.bi(),window.$=e.bind(null,Ki),window.game=Ki}();
</script>
