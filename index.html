<!DOCTYPE html><meta charset=utf8><meta name=viewport content="width=device-width, user-scalable=0"><title>GoodLuck (opt)</title><style>body,html{margin:0;overflow:hidden}canvas,main{height:100vh;position:absolute;user-select:none;width:100vw}</style><canvas id=scene></canvas><canvas id=billboard></canvas><main></main><script>!function(){function t(t,n){let i=t.i.t();for(let o of n)o(t,i);return i}function n(...n){return(i,o)=>{let e=[];for(let o of n){let n=t(i,o);e.push(n)}i.i.o[o]|=16,i.i.l[o]={l:e}}}function i(t,n){if(16&t.o[n])for(let o of t.l[n].l)i(t,o);t.h(n)}function o(t,n,o){switch(n){case 0:document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen();break;case 1:{let[n]=o;i(t.i,n),t.u++;break}case 2:t._++}}function e(t,n,i,o){return t.bindTexture(Yt,n),t.texImage2D(Yt,0,32856,i,o,0,6408,5121,null),t.texParameteri(Yt,10241,Wt),t.texParameteri(Yt,10240,Wt),n}function r(t,n,i,o){return t.bindTexture(Yt,n),t.texImage2D(Yt,0,33190,i,o,0,6402,5125,null),t.texParameteri(Yt,10241,Wt),t.texParameteri(Yt,10240,Wt),t.texParameteri(Yt,34892,34894),t.texParameteri(Yt,10242,33071),t.texParameteri(Yt,10243,33071),n}function l(t,n,i){let o={v:t.createFramebuffer(),m:n,p:i,g:e(t,t.createTexture(),n,i),M:r(t,t.createTexture(),n,i)};t.bindFramebuffer(Kt,o.v),t.framebufferTexture2D(Kt,36096,Yt,o.M,0),t.framebufferTexture2D(Kt,36064,Yt,o.g,0);let l=t.checkFramebufferStatus(Kt);if(36053!=l)throw Error(`Failed to set up the framebuffer (${l}).`);return o}function s(t,n,i){let o=t.createProgram();if(t.attachShader(o,c(t,35633,n)),t.attachShader(o,c(t,35632,i)),t.linkProgram(o),!t.getProgramParameter(o,35714))throw Error(t.getProgramInfoLog(o));return o}function c(t,n,i){let o=t.createShader(n);if(t.shaderSource(o,i),t.compileShader(o),!t.getShaderParameter(o,35713))throw Error(t.getShaderInfoLog(o));return o}function a(t,n,i){return Math.max(t,Math.min(n,i))}function f(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function h(t,n){let i=n[0],o=n[1],e=n[2],r=n[3],l=n[4],s=n[5],c=n[6],a=n[7],f=n[8],h=n[9],u=n[10],_=n[11],d=n[12],v=n[13],m=n[14],p=n[15],g=i*s-o*l,w=i*c-e*l,M=i*a-r*l,y=o*c-e*s,b=o*a-r*s,x=e*a-r*c,k=f*v-h*d,T=f*m-u*d,S=f*p-_*d,A=h*m-u*v,F=h*p-_*v,z=u*p-_*m,P=g*z-w*F+M*A+y*S-b*T+x*k;return P?(P=1/P,t[0]=(s*z-c*F+a*A)*P,t[1]=(e*F-o*z-r*A)*P,t[2]=(v*x-m*b+p*y)*P,t[3]=(u*b-h*x-_*y)*P,t[4]=(c*S-l*z-a*T)*P,t[5]=(i*z-e*S+r*T)*P,t[6]=(m*M-d*x-p*w)*P,t[7]=(f*x-u*M+_*w)*P,t[8]=(l*F-s*S+a*k)*P,t[9]=(o*S-i*F-r*k)*P,t[10]=(d*b-v*M+p*g)*P,t[11]=(h*M-f*b-_*g)*P,t[12]=(s*T-l*A-c*k)*P,t[13]=(i*A-o*T+e*k)*P,t[14]=(v*w-d*y-m*g)*P,t[15]=(f*y-h*w+u*g)*P,t):null}function u(t,n,i){let o=n[0],e=n[1],r=n[2],l=n[3],s=n[4],c=n[5],a=n[6],f=n[7],h=n[8],u=n[9],_=n[10],d=n[11],v=n[12],m=n[13],p=n[14],g=n[15],w=i[0],M=i[1],y=i[2],b=i[3];return t[0]=w*o+M*s+y*h+b*v,t[1]=w*e+M*c+y*u+b*m,t[2]=w*r+M*a+y*_+b*p,t[3]=w*l+M*f+y*d+b*g,w=i[4],M=i[5],y=i[6],b=i[7],t[4]=w*o+M*s+y*h+b*v,t[5]=w*e+M*c+y*u+b*m,t[6]=w*r+M*a+y*_+b*p,t[7]=w*l+M*f+y*d+b*g,w=i[8],M=i[9],y=i[10],b=i[11],t[8]=w*o+M*s+y*h+b*v,t[9]=w*e+M*c+y*u+b*m,t[10]=w*r+M*a+y*_+b*p,t[11]=w*l+M*f+y*d+b*g,w=i[12],M=i[13],y=i[14],b=i[15],t[12]=w*o+M*s+y*h+b*v,t[13]=w*e+M*c+y*u+b*m,t[14]=w*r+M*a+y*_+b*p,t[15]=w*l+M*f+y*d+b*g,t}function _(t,n,i,o,e){let r,l=1/Math.tan(n/2);return t[0]=l/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(r=1/(o-e),t[10]=(e+o)*r,t[14]=2*e*o*r):(t[10]=-1,t[14]=-2*o),t}function d(t,n){return t[0]=n[8],t[1]=n[9],t[2]=n[10],b(t,t)}function v(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function m(t,n){let i=function(t,n){let i=n[4],o=n[5],e=n[6],r=n[8],l=n[9],s=n[10];return t[0]=Math.hypot(n[0],n[1],n[2]),t[1]=Math.hypot(i,o,e),t[2]=Math.hypot(r,l,s),t}([0,0,0],n),o=1/i[0],e=1/i[1],r=1/i[2],l=n[0]*o,s=n[1]*e,c=n[2]*r,a=n[4]*o,f=n[5]*e,h=n[6]*r,u=n[8]*o,_=n[9]*e,d=n[10]*r,v=l+f+d,m=0;return v>0?(m=2*Math.sqrt(v+1),t[3]=.25*m,t[0]=(h-_)/m,t[1]=(u-c)/m,t[2]=(s-a)/m):l>f&&l>d?(m=2*Math.sqrt(1+l-f-d),t[3]=(h-_)/m,t[0]=.25*m,t[1]=(s+a)/m,t[2]=(u+c)/m):f>d?(m=2*Math.sqrt(1+f-l-d),t[3]=(u-c)/m,t[0]=(s+a)/m,t[1]=.25*m,t[2]=(h+_)/m):(m=2*Math.sqrt(1+d-l-f),t[3]=(s-a)/m,t[0]=(u+c)/m,t[1]=(h+_)/m,t[2]=.25*m),t}function p(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function g(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t}function w(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t}function M(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function y(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function b(t,n){let i=n[0],o=n[1],e=n[2],r=i*i+o*o+e*e;return r>0&&(r=1/Math.sqrt(r)),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function x(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function k(t,n,i){let o=n[0],e=n[1],r=n[2],l=i[3]*o+i[7]*e+i[11]*r+i[15];return l=l||1,t[0]=(i[0]*o+i[4]*e+i[8]*r+i[12])/l,t[1]=(i[1]*o+i[5]*e+i[9]*r+i[13])/l,t[2]=(i[2]*o+i[6]*e+i[10]*r+i[14])/l,t}function T(t,n,i){return w(t,k([0,0,0],n,i),v([0,0,0],i))}function S(t,n,i,o){let e=n[0],r=n[1],l=n[2];return t[0]=e+o*(i[0]-e),t[1]=r+o*(i[1]-r),t[2]=l+o*(i[2]-l),t}function A(t,n,i){let o=n[0],e=n[1],r=n[2],l=n[3],s=i[0],c=i[1],a=i[2],f=i[3];return t[0]=o*f+l*s+e*a-r*c,t[1]=e*f+l*c+r*s-o*a,t[2]=r*f+l*a+o*c-e*s,t[3]=l*f-o*s-e*c-r*a,t}function F(t,n,i,o){let e=Math.sin(n/2*on),r=Math.cos(n/2*on),l=Math.sin(i/2*on),s=Math.cos(i/2*on),c=Math.sin(o/2*on),a=Math.cos(o/2*on);return t[0]=e*s*a+r*l*c,t[1]=r*l*a-e*s*c,t[2]=r*s*c-e*l*a,t[3]=r*s*a+e*l*c,t}function z(t){return 57.29577951308232*Math.asin(-a(-1,1,2*(t[1]*t[2]-t[3]*t[0])))}function P(t,n,i){let o=i/2;return t[0]=Math.sin(o)*n[0],t[1]=Math.sin(o)*n[1],t[2]=Math.sin(o)*n[2],t[3]=Math.cos(o),t}function $(t,n,i,o){let e,r,l,s,c,a=n[0],f=n[1],h=n[2],u=n[3],_=i[0],d=i[1],v=i[2],m=i[3];return r=a*_+f*d+h*v+u*m,r<0&&(r=-r,_=-_,d=-d,v=-v,m=-m),1-r>1e-6?(e=Math.acos(r),l=Math.sin(e),s=Math.sin((1-o)*e)/l,c=Math.sin(o*e)/l):(s=1-o,c=o),t[0]=s*a+c*_,t[1]=s*f+c*d,t[2]=s*h+c*v,t[3]=s*u+c*m,t}function C(t,n,i){let o=t.i.k[n],e=t.i.T[n];if(e.S){let t=e.A[e.S];t&&t!==e.F&&(0===e.F.P?e.F=t:1&e.F.$&&(e.F.P=0,e.F=t)),e.S=void 0}let r=null,l=null;for(let t of e.F.C){if(e.F.P<t.L){l=t;break}r=t}if(r&&l){let t=(e.F.P-r.L)/(l.L-r.L);l.I&&(t=l.I(t)),r.X&&l.X&&(S(o.X,r.X,l.X,t),o.D=!0),r.H&&l.H&&($(o.H,r.H,l.H,t),o.D=!0),r.V&&l.V&&(S(o.V,r.V,l.V,t),o.D=!0)}let s=e.F.P+i;if(s<e.F.G)e.F.P=s;else{if(e.F.P=0,4&e.F.$)for(let t of e.F.C.reverse())t.L=e.F.G-t.L;2&e.F.$||(e.F=e.A.idle)}}function L(t,n){let i=t.i.k[n];var o,e;v(sn,i.i),d(cn,i.i),(o=an)[0]=(e=i.i)[4],o[1]=e[5],o[2]=e[6],b(o,o);let r=t.Audio.listener;r.positionX?(r.positionX.value=sn[0],r.positionY.value=sn[1],r.positionZ.value=sn[2],r.forwardX.value=cn[0],r.forwardY.value=cn[1],r.forwardZ.value=cn[2],r.upX.value=an[0],r.upY.value=an[1],r.upZ.value=an[2]):(r.setPosition(...sn),r.setOrientation(...cn,...an))}function I(t,n,i,o,e){let r=t.currentTime+e,l=0;n&&n.connect(t.destination);let s,c,a=t.createGain();if(a.gain.value=(i[0]/9)**3,i[5]&&(c=t.createOscillator(),c.type=i[5],c.frequency.value=(i[7]/3)**3,s=t.createGain(),s.gain.value=(i[6]+3)**3,c.connect(s)),i[1]){let o=t.createBiquadFilter();o.type=i[1],o.frequency.value=2**i[2],o.Q.value=i[3]**1.5,s&&i[4]&&s.connect(o.detune),a.connect(o),o.connect(n||t.destination)}else a.connect(n||t.destination);for(let n of i[8]){let i=t.createGain();i.connect(a);let e=(n[1]/9)**3,c=(n[2]/9)**3,f=(n[3]/9)**3,h=c+f+(n[4]/6)**3;if(i.gain.setValueAtTime(0,r),i.gain.linearRampToValueAtTime(e,r+c),i.gain.setValueAtTime(e,r+c+f),i.gain.exponentialRampToValueAtTime(1e-5,r+h),n[0]){let e=t.createOscillator();e.type=n[0],e.connect(i),e.detune.value=3*(n[5]-7.5)**3,s&&n[6]&&s.connect(e.detune);let l=440*2**((o-69)/12);if(n[7]){let t=(n[8]/9)**3,i=(n[9]/9)**3,o=(n[10]/6)**3;e.frequency.linearRampToValueAtTime(0,r),e.frequency.linearRampToValueAtTime(l,r+t),e.frequency.setValueAtTime(l,r+t+i),e.frequency.exponentialRampToValueAtTime(1e-5,r+t+i+o)}else e.frequency.setValueAtTime(l,r);e.start(r),e.stop(r+h)}else{let n=t.createBufferSource();n.buffer=X(t),n.loop=!0,n.connect(i),n.start(r),n.stop(r+h)}h>l&&(l=h)}c&&(c.start(r),c.stop(r+l))}function X(t){if(!ln){ln=t.createBuffer(1,2*t.sampleRate,t.sampleRate);let n=ln.getChannelData(0);for(let t=0;t<n.length;t++)n[t]=2*Math.random()-1}return ln}function D(t,n,i){let o=t.i.W[n],e=t.i.k[n];if(o.F&&(o.P+=i,o.P>o.F.Y?o.F=void 0:o.R&&H(o.R,e)),o.S&&!o.F){switch(o.S.K){case 0:!function(t,n,i){let o=t.createBufferSource();o.buffer=i.N,n?(o.connect(n),n.connect(t.destination)):o.connect(t.destination),o.start()}(t.Audio,o.R,o.S);break;case 1:!function(t,n,i){let o=60/(i.j||120)/4;for(let e of i.B)for(let i=0;i<e.U.length;i++)e.U[i]&&I(t,n,e.O,e.U[i],i*o)}(t.Audio,o.R,o.S)}o.F=o.S,o.P=0,o.R&&H(o.R,e)}o.S=o.q}function H(t,n){v(hn,n.i),d(un,n.i),t.positionX?(t.positionX.value=hn[0],t.positionY.value=hn[1],t.positionZ.value=hn[2],t.orientationX.value=un[0],t.orientationY.value=un[1],t.orientationZ.value=un[2]):(t.setPosition(...hn),t.setOrientation(...un))}function V(t,n){n>1?(_(t.J,t.Z,n,t.tt,t.nt),h(t.it,t.J)):(_(t.J,t.Z/n,n,t.tt,t.nt),h(t.it,t.J))}function E(t){!function(t,n,i,o,e,r,l){let s=1/(e-i),c=1/(o-n),a=1/(r-l);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*a,t[11]=0,t[12]=(e+i)*s,t[13]=(n+o)*c,t[14]=(l+r)*a,t[15]=1}(t.J,t.ot,t.ot,-t.ot,-t.ot,t.tt,t.nt),h(t.it,t.J)}function G(t,n){let i,o,e,r,l,s;v(n.et,t),i=r=n.et[0],o=l=n.et[1],e=s=n.et[2];let c=[0,0,0];for(let a=0;a<8;a++){let f=dn[a];c[0]=f[0]*n.rt[0],c[1]=f[1]*n.rt[1],c[2]=f[2]*n.rt[2],k(c,c,t),c[0]<i&&(i=c[0]),c[0]>r&&(r=c[0]),c[1]<o&&(o=c[1]),c[1]>l&&(l=c[1]),c[2]<e&&(e=c[2]),c[2]>s&&(s=c[2])}n.lt=[i,o,e],n.st=[r,l,s],n.ct[0]=(r-i)/2,n.ct[1]=(l-o)/2,n.ct[2]=(s-e)/2}function W(t,n){let i=t.et[0]-n.et[0],o=t.ct[0]+n.ct[0]-Math.abs(i),e=t.et[1]-n.et[1],r=t.ct[1]+n.ct[1]-Math.abs(e),l=t.et[2]-n.et[2],s=t.ct[2]+n.ct[2]-Math.abs(l);return o<r&&o<s?[o*Math.sign(i),0,0]:r<s?[0,r*Math.sign(e),0]:[0,0,s*Math.sign(l)]}function Y(t,n){return t.lt[0]<n.st[0]&&t.st[0]>n.lt[0]&&t.lt[1]<n.st[1]&&t.st[1]>n.lt[1]&&t.lt[2]<n.st[2]&&t.st[2]>n.lt[2]}function R(t,n,i){for(let o=0;o<i;o++){let i=n[o],e=t.o&i.at,r=i.o&t.at;if((e||r)&&Y(t,i)){let n=W(t,i);e&&t.ft.push({ht:i.Entity,ut:n}),r&&i.ft.push({ht:t.Entity,ut:y([0,0,0],n)})}}}function K(t,n){let i=t.i._t[n],o=t.i.dt[n];i.vt&&o.gt.push(i.vt.slice()),i.H&&o.wt.push(i.H.slice())}function N(t,n){let i=t.i.Mt[n];if(i.dt){let i=t.i.dt[n];t.yt.KeyW&&i.gt.push([0,0,1]),t.yt.KeyA&&i.gt.push([1,0,0]),t.yt.KeyS&&i.gt.push([0,0,-1]),t.yt.KeyD&&i.gt.push([-1,0,0])}if(i.bt){let i=t.i.dt[n];t.yt.ArrowLeft&&i.wt.push([0,1,0,0]),t.yt.ArrowRight&&i.wt.push([0,-1,0,0])}if(i.xt){let o=t.i.dt[n],e=z(t.i.k[n].H);t.yt.ArrowUp&&e>i.kt&&o.Tt.push([-1,0,0,0]),t.yt.ArrowDown&&e<i.St&&o.Tt.push([1,0,0,0])}}function j(t,n){let i=t.i.Mt[n],o=t.i.k[n];if(i.bt&&t.At.MouseX&&(P(Mn,wn,-t.At.MouseX*i.bt*on),A(o.H,Mn,o.H),o.D=!0),i.xt&&t.At.MouseY){let n=z(o.H),e=a(i.kt-n,i.St-n,t.At.MouseY*i.xt);P(Mn,gn,e*on),A(o.H,o.H,Mn),o.D=!0}}function B(t,n){let i=t.i.k[n],o=t.i.Mt[n],e=t.i.dt[n];if(o.dt&&1===t.yt.Touch0){let n=Math.min(t.Ft,t.zt)/4,i=(t.yt.Touch0X-xn[0])/n,o=(t.yt.Touch0Y-xn[1])/n;Math.abs(i)>.01&&e.gt.push([a(-1,1,-i),0,0]),Math.abs(o)>.01&&e.gt.push([0,0,a(-1,1,-o)])}if(o.bt&&t.At.Touch1X&&(P(kn,yn,-t.At.Touch1X*o.bt*10*on),A(i.H,kn,i.H),i.D=!0),o.xt&&t.At.Touch1Y){let n=z(i.H),e=a(o.kt-n,o.St-n,t.At.Touch1Y*o.xt*10);P(kn,bn,e*on),A(i.H,i.H,kn),i.D=!0}}function U(t,n){let i=t.i.Mt[n];if(i.dt){let i=t.i.dt[n];Math.abs(t.At.pad0_axis_1)>An&&i.gt.push([-t.At.pad0_axis_1,0,0]),Math.abs(t.At.pad0_axis_2)>An&&i.gt.push([0,0,-t.At.pad0_axis_2])}if(i.bt&&Math.abs(t.At.pad0_axis_3)>An&&t.i.dt[n].wt.push(P([0,0,0,0],Tn,-t.At.pad0_axis_3*Math.PI)),i.xt&&Math.abs(t.At.pad0_axis_4)>An){let o=t.i.dt[n],e=t.At.pad0_axis_4*Math.PI,r=z(t.i.k[n].H);(e<0&&r>i.kt||e>0&&r<i.St)&&o.Tt.push(P([0,0,0,0],Sn,e))}}function O(t,n){t.Pt.textAlign="center",t.Pt.font=n.$t,t.Pt.fillStyle=n.Ct,t.Pt.fillText(n.Text,0,0)}function q(t,n){t.Pt.strokeStyle=n.Lt,t.Pt.strokeRect(-n.rt/2,-n.rt/2,n.rt,n.rt)}function J(t,n,e){let r=t.i.It[n];r.Xt-=e,r.Xt<0&&(r.Dt&&o(t,r.Dt,n),i(t.i,n))}function Q(t,n,i){let o=t.i.Ht[n];v(Pn,t.i.k[n].i),1===o.K&&b(Pn,Pn),t.Vt[4*i+0]=Pn[0],t.Vt[4*i+1]=Pn[1],t.Vt[4*i+2]=Pn[2],t.Vt[4*i+3]=o.K,t.Et[4*i+0]=o.Lt[0],t.Et[4*i+1]=o.Lt[1],t.Et[4*i+2]=o.Lt[2],t.Et[4*i+3]=o.Gt}function Z(t,n,i){let o=t.i.k[n],e=t.i.dt[n];if(e.gt.length){let n=e.gt.reduce(tt),r=Math.min(1,function(t){return Math.hypot(t[0],t[1],t[2])}(n));T(n,n,o.i),void 0!==o.Wt&&T(n,n,t.i.k[o.Wt].Yt),b(n,n),M(n,n,r*e.Rt*i),g(o.X,o.X,n),o.D=!0,e.gt=[]}if(e.wt.length){let t=e.wt.reduce(nt);$(t,Ln,t,Math.min(1,e.Kt/Math.PI*i)),A(o.H,t,o.H),o.D=!0,e.wt=[]}if(e.Tt.length){let t=e.Tt.reduce(nt);$(t,Ln,t,Math.min(1,e.Kt/Math.PI*i)),A(o.H,o.H,t),o.D=!0,e.Tt=[]}}function tt(t,n){return g(t,t,n)}function nt(t,n){return A(t,t,n)}function it(t,n,i){let o=t.i.k[n],e=t.i.Nt[n];if(1===e.K){p(e.jt,e.Bt),M(e.Ut,e.Ut,i),g(e.jt,e.jt,e.Ut),e.jt[1]+=-9.81*i;let t=[0,0,0];M(t,e.jt,i),g(o.X,o.X,t),o.D=!0,(r=e.Ut)[0]=0,r[1]=0,r[2]=0}var r}function ot(t,n,i){let o=t.i.Nt[n];if(2===o.K){let e=[0,0,0];v(e,t.i.k[n].i);let r=[0,0,0];w(r,e,o.Ot),M(o.jt,r,1/i),p(o.Ot,e)}}function et(t,n){let i=t.i.k[n],o=t.i.qt[n],e=t.i.Nt[n];if(1===e.K){let n=!1;for(let r=0;r<o.ft.length;r++){let l=o.ft[r];if(32768&t.i.o[l.ht]){n=!0,g(i.X,i.X,l.ut),i.D=!0;let o=t.i.Nt[l.ht];switch(o.K){case 0:b(Hn,l.ut),M(Hn,Hn,-2*x(e.jt,Hn)),g(e.Bt,e.jt,Hn);break;case 1:case 2:p(e.Bt,o.jt)}M(e.Bt,e.Bt,e.Jt),l.ut[1]>0&&e.Bt[1]<1&&(e.Bt[1]=0)}}n||p(e.Bt,e.jt)}}function rt(t,n){if(16&t.o[n]){let i=t.l[n];for(let n of i.l)if(262144&t.o[n])return!0}return!1}function lt(t,n){t.Qt.bindFramebuffer(Kt,n.Zt.v),t.Qt.viewport(0,0,n.Zt.m,n.Zt.p),t.Qt.clearColor(...n.tn),t.Qt.clear(16640),t.Qt.useProgram(t.on.nn),t.Qt.uniformMatrix4fv(t.on.rn.en,!1,n.en);let i=null;for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&En)===En){let o=t.i.k[n],e=t.i.ln[n];switch(e.sn!==i&&(i=e.sn,t.Qt.frontFace(e.sn)),t.Qt.uniformMatrix4fv(t.on.rn.i,!1,o.i),e.K){case 7:break;default:t.Qt.bindVertexArray(e.cn),t.Qt.drawElements(t.on.an,e.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}}}function st(t,n){t.Qt.bindFramebuffer(Kt,null),t.Qt.viewport(0,0,t.Ft,t.zt),t.Qt.clearColor(...n.tn),t.Qt.clear(16640),at(t,n)}function ct(t,n){t.Qt.bindFramebuffer(Kt,n.Zt.v),t.Qt.viewport(0,0,n.Zt.m,n.Zt.p),t.Qt.clearColor(...n.tn),t.Qt.clear(16640),at(t,n,n.Zt.un)}function at(t,n,i){let o=null,e=null;for(let r=0;r<t.i.o.length;r++)if((t.i.o[r]&Gn)===Gn){let l=t.i.k[r],s=t.i.ln[r];if(s._n!==o)switch(o=s._n,s.K){case 0:ft(t,s._n,n);break;case 1:ut(t,s._n,n);break;case 4:dt(t,s._n,n);break;case 5:mt(t,s._n,n);break;case 7:gt(t,s._n,n);break;case 6:Mt(t,s._n,n);break;case 2:bt(t,s._n,n)}switch(s.sn!==e&&(e=s.sn,t.Qt.frontFace(s.sn)),s.K){case 0:ht(t,l,s);break;case 1:_t(t,l,s);break;case 4:s.dn!==i&&vt(t,l,s);break;case 5:s.dn!==i&&pt(t,l,s);break;case 7:wt(t,l,s);break;case 6:yt(t,l,s);break;case 2:xt(t,l,s)}}}function ft(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en)}function ht(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.uniform4fv(i._n.rn.Lt,i.Lt),t.Qt.bindVertexArray(i.cn),t.Qt.drawElements(i._n.an,i.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}function ut(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en),t.Qt.uniform3fv(n.rn.vn,i.mn),t.Qt.uniform4fv(n.rn.Vt,t.Vt),t.Qt.uniform4fv(n.rn.Et,t.Et)}function _t(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.uniformMatrix4fv(i._n.rn.Yt,!1,n.Yt),t.Qt.uniform4fv(i._n.rn.pn,i.pn),t.Qt.uniform4fv(i._n.rn.gn,i.gn),t.Qt.uniform1f(i._n.rn.wn,i.wn),t.Qt.bindVertexArray(i.cn),t.Qt.drawElements(i._n.an,i.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}function dt(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en)}function vt(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.activeTexture(Rt),t.Qt.bindTexture(Yt,i.dn),t.Qt.uniform1i(i._n.rn.Mn,0),t.Qt.uniform4fv(i._n.rn.Lt,i.Lt),t.Qt.bindVertexArray(i.cn),t.Qt.drawElements(i._n.an,i.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}function mt(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en),t.Qt.uniform3fv(n.rn.vn,i.mn),t.Qt.uniform4fv(n.rn.Vt,t.Vt),t.Qt.uniform4fv(n.rn.Et,t.Et)}function pt(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.uniformMatrix4fv(i._n.rn.Yt,!1,n.Yt),t.Qt.uniform4fv(i._n.rn.pn,i.pn),t.Qt.uniform4fv(i._n.rn.gn,i.gn),t.Qt.uniform1f(i._n.rn.wn,i.wn),t.Qt.activeTexture(Rt),t.Qt.bindTexture(Yt,i.dn),t.Qt.uniform1i(i._n.rn.yn,0),t.Qt.bindVertexArray(i.cn),t.Qt.drawElements(i._n.an,i.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}function gt(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en)}function wt(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.uniform4fv(i._n.rn.Lt,i.Lt),t.Qt.bindBuffer(Et,i.bn),t.Qt.enableVertexAttribArray(i._n.rn.xn),t.Qt.vertexAttribPointer(i._n.rn.xn,3,jt,!1,0,0),t.Qt.drawArrays(i._n.an,0,i.fn)}function Mt(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en),t.Qt.uniform3fv(n.rn.vn,i.mn),t.Qt.uniform4fv(n.rn.Vt,t.Vt),t.Qt.uniform4fv(n.rn.Et,t.Et)}function yt(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.uniformMatrix4fv(i._n.rn.Yt,!1,n.Yt),t.Qt.uniform4fv(i._n.rn.pn,i.pn),t.Qt.activeTexture(33985),t.Qt.bindTexture(Yt,i.yn),t.Qt.uniform1i(i._n.rn.yn,1),t.Qt.activeTexture(33986),t.Qt.bindTexture(Yt,i.kn),t.Qt.uniform1i(i._n.rn.kn,2),t.Qt.activeTexture(33987),t.Qt.bindTexture(Yt,i.Tn),t.Qt.uniform1i(i._n.rn.Tn,3),t.Qt.bindVertexArray(i.cn),t.Qt.drawElements(i._n.an,i.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}function bt(t,n,i){t.Qt.useProgram(n.nn),t.Qt.uniformMatrix4fv(n.rn.en,!1,i.en),t.Qt.uniform3fv(n.rn.vn,i.mn),t.Qt.uniform4fv(n.rn.Vt,t.Vt),t.Qt.uniform4fv(n.rn.Et,t.Et),t.Qt.activeTexture(Rt),t.Qt.bindTexture(Yt,t.An.Sn.M),t.Qt.uniform1i(n.rn.Fn,0);let o=function(t,n){for(let n=0;n<t.o.length;n++)if(1032==(1032&t.o[n]))return n}(t.i);o&&t.Qt.uniformMatrix4fv(n.rn.zn,!1,t.i.Pn[o].en)}function xt(t,n,i){t.Qt.uniformMatrix4fv(i._n.rn.i,!1,n.i),t.Qt.uniformMatrix4fv(i._n.rn.Yt,!1,n.Yt),t.Qt.uniform4fv(i._n.rn.pn,i.pn),t.Qt.uniform4fv(i._n.rn.gn,i.gn),t.Qt.uniform1f(i._n.rn.wn,i.wn),t.Qt.bindVertexArray(i.cn),t.Qt.drawElements(i._n.an,i.hn.fn,Nt,0),t.Qt.bindVertexArray(null)}function kt(t,n){let i=t.i.$n[n],o=t.i.k[n];o.X=[Math.random()-.5,Math.random()-.5,Math.random()-.5],M(o.X,o.X,2*i.Cn),o.D=!0}function Tt(t=[0,0,0],n=[0,0,0,1],i=[1,1,1]){return(o,e)=>{o.i.o[e]|=1048576,o.i.k[e]={i:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Yt:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X:t,H:n,V:i,D:!0}}}function St(n,i,o){let e=n.i.Ln[i];if(e.In+=o,e.In>e.Xn){e.In=0;let o=n.i.k[i],r=[0,0,0];v(r,o.i);let l=[0,0,0,0];m(l,o.i),t(n,[...e.Dn(n),Tt(r,l)])}}function At(t,n,i){let o=t.i.Hn[n];o.In+=i,o.In>o.Vn&&(o.In=0,o.En?(o.En=!1,t.i.o[n]&=~o.Gn):(o.En=!0,t.i.o[n]|=o.Gn))}function Ft(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Kn)===Kn){let i=t.i.k[n];i.D&&zt(t.i,n,i)}}function zt(t,n,i){if(i.D=!1,function(t,n,i,o){let e=n[0],r=n[1],l=n[2],s=n[3],c=e+e,a=r+r,f=l+l,h=e*c,u=e*a,_=e*f,d=r*a,v=r*f,m=l*f,p=s*c,g=s*a,w=s*f,M=o[0],y=o[1],b=o[2];t[0]=(1-(d+m))*M,t[1]=(u+w)*M,t[2]=(_-g)*M,t[3]=0,t[4]=(u-w)*y,t[5]=(1-(h+m))*y,t[6]=(v+p)*y,t[7]=0,t[8]=(_+g)*b,t[9]=(v-p)*b,t[10]=(1-(h+d))*b,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1}(i.i,i.H,i.X,i.V),void 0!==i.Wt&&u(i.i,t.k[i.Wt].i,i.i),h(i.Yt,i.i),16&t.o[n]){let i=t.l[n];for(let o of i.l)if(1048576&t.o[o]){let i=t.k[o];i.Wt=n,zt(t,o,i)}}}function Pt(t,n){let i=t.i.qt[n],e=t.i.S[n];for(let r of i.ft)e.Gn&t.i.qt[r.ht].at&&o(t,e.Dt,[n,r.ht])}function $t(t,...n){return t.reduce(((t,i)=>t+function(t){let n=t.shift();return"boolean"==typeof n||null==n?"":Array.isArray(n)?n.join(""):n}(n)+i))}function Ct(t,n,i,o=[.9,.9,.9,1]){return(e,r)=>{e.i.o[r]|=8,e.i.Pn[r]={K:0,J:{K:0,Z:t,tt:n,nt:i,J:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],it:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Wn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],en:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],mn:[0,0,0],tn:o}}}function Lt(t,n,i,o,e=[0,0,0,1]){return(r,l)=>{r.i.o[l]|=8,r.i.Pn[l]={K:3,Zt:t,J:{K:1,ot:n,tt:i,nt:o,J:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],it:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Wn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],en:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],mn:[0,0,0],tn:e}}}function It(t,n){return(i,o)=>{i.i.o[o]|=64,i.i._t[o]={vt:t,H:n}}}function Xt(t=[1,1,1],n=1){return(i,o)=>{i.i.o[o]|=1024,i.i.Ht[o]={K:1,Lt:t,Gt:n**2}}}function Dt(t){return[It(null,[0,1,0,0]),(t,n)=>{t.i.o[n]|=4096,t.i.dt[n]={Rt:0,Kt:.5,gt:[],wt:[],Tt:[]}},n([Tt([0,0,10]),Xt([1,1,1],.9),Lt(t.An.Sn,10,1,100)])]}function Ht(t,n,i,o=0,e=[1,1,1,1],r=2304){return(l,s)=>{if(!Un.has(n)){let i=l.Qt.createVertexArray();l.Qt.bindVertexArray(i),l.Qt.bindBuffer(Et,n.bn),l.Qt.enableVertexAttribArray(t.rn.xn),l.Qt.vertexAttribPointer(t.rn.xn,3,jt,!1,0,0),l.Qt.bindBuffer(Et,n.Yn),l.Qt.enableVertexAttribArray(t.rn.Rn),l.Qt.vertexAttribPointer(t.rn.Rn,3,jt,!1,0,0),l.Qt.bindBuffer(Gt,n.Kn),l.Qt.bindVertexArray(null),Un.set(n,i)}l.i.o[s]|=16384,l.i.ln[s]={K:2,_n:t,hn:n,sn:r,cn:Un.get(n),pn:i,gn:e,wn:o}}}const Vt=35044,Et=34962,Gt=34963,Wt=9729,Yt=3553,Rt=33984,Kt=36160,Nt=5123,jt=5126,Bt=document.getElementById("update"),Ut=document.getElementById("delta"),Ot=document.getElementById("fps"),qt=1/60;let Jt=Float32Array.from([-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]),Qt=Float32Array.from([-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0]),Zt=Float32Array.from([.666667,.333333,.333333,.333333,.333333,0,.666667,0,.333333,.666667,0,.666667,0,.333333,.333333,.333333,.333333,.333333,0,.333333,0,0,.333333,0,.333333,.666667,.333333,.333333,.666667,.333333,.666667,.666667,1,.333333,.666667,.333333,.666667,0,1,0,.333333,.666667,.333333,1,0,1,0,.666667]),tn=Float32Array.from([]),nn=Uint16Array.from([23,22,20,22,21,20,19,18,16,18,17,16,15,14,12,14,13,12,11,10,8,10,9,8,7,6,4,6,5,4,3,2,0,2,1,0]);const on=Math.PI/180,en=1048577,rn=1048578;let ln,sn=[0,0,0],cn=[0,0,0],an=[0,0,0];const fn=1048580,hn=[0,0,0],un=[0,0,0],_n=1048584,dn=[[.5,.5,.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,-.5,.5]],vn=1048608,mn=1052736,pn=1052800,gn=[1,0,0],wn=[0,1,0],Mn=[0,0,0,0],yn=[0,1,0],bn=[1,0,0],xn=[0,0],kn=[0,0,0,0],Tn=[0,1,0],Sn=[1,0,0],An=.1,Fn=1048832,zn=1049600;let Pn=[0,0,0];const $n=1050624,Cn=1052672,Ln=[0,0,0,1],In=1081344,Xn=1081344,Dn=1081376;let Hn=[0,0,0];const Vn=262144,En=1064960,Gn=1064960,Wn=1114112,Yn=1179648,Rn=524288,Kn=1048576,Nn=3145760;let jn;class Bn extends class{constructor(){this.o=[],this.Nn=[]}t(){return this.Nn.length>0?this.Nn.pop():this.o.push(0)-1}h(t){this.o[t]=0,this.Nn.push(t)}}{constructor(){super(...arguments),this.T=[],this.W=[],this.Pn=[],this.l=[],this.qt=[],this._t=[],this.Mt=[],this.jn=[],this.It=[],this.Ht=[],this.Bn=[],this.dt=[],this.Un=[],this.ln=[],this.Nt=[],this.$n=[],this.Ln=[],this.On=[],this.Hn=[],this.k=[],this.S=[]}}const Un=new WeakMap;let On=new class extends class extends class{constructor(){this.qn=0,this.Jn=0,this.Ft=window.innerWidth,this.zt=window.innerHeight,this.Qn=!0,this.yt={MouseX:0,MouseY:0},this.At={MouseX:0,MouseY:0},this.Zn={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.ti={},this.ni=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.ii():this.oi())),this.ni.addEventListener("contextmenu",(t=>t.preventDefault())),this.ni.addEventListener("mousedown",(t=>{this.yt["Mouse"+t.button]=1,this.At["Mouse"+t.button]=1})),this.ni.addEventListener("mouseup",(t=>{this.yt["Mouse"+t.button]=0,this.At["Mouse"+t.button]=-1})),this.ni.addEventListener("mousemove",(t=>{this.yt.MouseX=t.clientX,this.yt.MouseY=t.clientY,this.At.MouseX=t.movementX,this.At.MouseY=t.movementY})),this.ni.addEventListener("wheel",(t=>{t.preventDefault(),this.At.WheelY=t.deltaY})),this.ni.addEventListener("touchstart",(t=>{t.preventDefault(),1===t.touches.length&&(this.ti={});for(let n=0;n<t.touches.length;n++)this.ti[t.touches[n].identifier]=n;for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],o=this.ti[i.identifier];this.yt["Touch"+o]=1,this.yt[`Touch${o}X`]=i.clientX,this.yt[`Touch${o}Y`]=i.clientY,this.At["Touch"+o]=1,this.At[`Touch${o}X`]=0,this.At[`Touch${o}Y`]=0}})),this.ni.addEventListener("touchmove",(t=>{t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],o=this.ti[i.identifier];this.At[`Touch${o}X`]=i.clientX-this.yt[`Touch${o}X`],this.At[`Touch${o}Y`]=i.clientY-this.yt[`Touch${o}Y`],this.yt[`Touch${o}X`]=i.clientX,this.yt[`Touch${o}Y`]=i.clientY}})),this.ni.addEventListener("touchend",(t=>{t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=this.ti[t.changedTouches[n].identifier];this.yt["Touch"+i]=0,this.At["Touch"+i]=-1}})),this.ni.addEventListener("touchcancel",(t=>{t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=this.ti[t.changedTouches[n].identifier];this.yt["Touch"+i]=0,this.At["Touch"+i]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.yt[t.code]=1,this.At[t.code]=1)})),window.addEventListener("keyup",(t=>{this.yt[t.code]=0,this.At[t.code]=-1}))}oi(){let t=0,n=performance.now(),i=o=>{let e=(o-n)/1e3;for(this.ei(e),t+=e;t>=qt;)t-=qt,this.ri(qt);this.li(e),this.si(e),n=o,this.qn=requestAnimationFrame(i)};this.ii(),i(n)}ii(){cancelAnimationFrame(this.qn),this.qn=0}ei(t){this.Jn=performance.now();let n=Math.abs(this.At.MouseX)+Math.abs(this.At.MouseY);this.Zn.Mouse+=n,1===this.yt.Mouse0&&(this.Zn.Mouse0+=n),1===this.yt.Mouse1&&(this.Zn.Mouse1+=n),1===this.yt.Mouse2&&(this.Zn.Mouse2+=n),1===this.yt.Touch0&&(this.Zn.Touch0+=Math.abs(this.At.Touch0X)+Math.abs(this.At.Touch0Y)),1===this.yt.Touch1&&(this.Zn.Touch1+=Math.abs(this.At.Touch1X)+Math.abs(this.At.Touch1Y))}ri(t){}li(t){}si(t){this.Qn=!1,-1===this.At.Mouse0&&(this.Zn.Mouse0=0),-1===this.At.Mouse1&&(this.Zn.Mouse1=0),-1===this.At.Mouse2&&(this.Zn.Mouse2=0),-1===this.At.Touch0&&(this.Zn.Touch0=0),-1===this.At.Touch1&&(this.Zn.Touch1=0);for(let t in this.At)this.At[t]=0;let n=performance.now()-this.Jn;Bt&&(Bt.textContent=n.toFixed(1)),Ut&&(Ut.textContent=(1e3*t).toFixed(1)),Ot&&(Ot.textContent=(1/t).toFixed())}}{constructor(){super(),this.ci=document.querySelector("#billboard"),this.Pt=this.ci.getContext("2d"),this.ai=document.querySelector("#scene"),this.Qt=this.ai.getContext("webgl2"),this.Audio=new AudioContext,this.Qt.enable(2929),this.Qt.enable(2884)}}{constructor(){super(...arguments),this.i=new Bn,this.fi=function(t){let n=s(t,"#version 300 es\n\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nin vec3 attr_position;\nin vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * vec4(attr_position, 1.0);\nvert_normal = (vec4(attr_normal, 1.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform float shininess;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = diffuse_color.rgb * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += diffuse_color.rgb * diffuse_factor * light_color * light_intensity;\n\nif (shininess > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, shininess);\n\n\nlight_acc += specular_color.rgb * specular_factor * light_color * light_intensity;\n}\n}\n}\n\nfrag_color = vec4(light_acc, 1.0);\n}\n");return{an:4,nn:n,rn:{en:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),Yt:t.getUniformLocation(n,"self"),pn:t.getUniformLocation(n,"diffuse_color"),gn:t.getUniformLocation(n,"specular_color"),wn:t.getUniformLocation(n,"shininess"),vn:t.getUniformLocation(n,"eye"),Vt:t.getUniformLocation(n,"light_positions"),Et:t.getUniformLocation(n,"light_details"),xn:t.getAttribLocation(n,"attr_position"),Rn:t.getAttribLocation(n,"attr_normal")}}}(this.Qt),this.hi=function(t){let n=s(t,"#version 300 es\n\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nin vec3 attr_position;\nin vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * vec4(attr_position, 1.0);\nvert_normal = (vec4(attr_normal, 1.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\nprecision lowp sampler2DShadow;\n\n\nconst int MAX_LIGHTS = 8;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform float shininess;\nuniform vec4 light_positions[MAX_LIGHTS];\nuniform vec4 light_details[MAX_LIGHTS];\nuniform mat4 shadow_space;\nuniform sampler2DShadow shadow_map;\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\n\n\nfloat shadow_factor(vec4 world_pos, float min) {\nvec4 shadow_space_pos = shadow_space * world_pos;\nvec3 shadow_space_ndc = shadow_space_pos.xyz / shadow_space_pos.w;\n\nshadow_space_ndc = shadow_space_ndc * 0.5 + 0.5;\n\n\nshadow_space_ndc.z -= 0.001;\n\nreturn texture(shadow_map, shadow_space_ndc) * (1.0 - min) + min;\n}\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = diffuse_color.rgb * 0.1;\n\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (light_positions[i].w == 0.0) {\nbreak;\n}\n\nvec3 light_color = light_details[i].rgb;\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_positions[i].w == 1.0) {\n\nlight_normal = light_positions[i].xyz;\n} else {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += diffuse_color.rgb * diffuse_factor * light_color * light_intensity;\n\nif (shininess > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, shininess);\n\n\nlight_acc += specular_color.rgb * specular_factor * light_color * light_intensity;\n}\n}\n}\n\nvec3 shaded_rgb = light_acc * shadow_factor(vert_position, 0.5);\nfrag_color= vec4(shaded_rgb, 1.0);\n}\n");return{an:4,nn:n,rn:{en:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),Yt:t.getUniformLocation(n,"self"),pn:t.getUniformLocation(n,"diffuse_color"),gn:t.getUniformLocation(n,"specular_color"),wn:t.getUniformLocation(n,"shininess"),vn:t.getUniformLocation(n,"eye"),Vt:t.getUniformLocation(n,"light_positions"),Et:t.getUniformLocation(n,"light_details"),zn:t.getUniformLocation(n,"shadow_space"),Fn:t.getUniformLocation(n,"shadow_map"),xn:t.getAttribLocation(n,"attr_position"),Rn:t.getAttribLocation(n,"attr_normal")}}}(this.Qt),this.on=function(t){let n=s(t,"#version 300 es\n\n\nuniform mat4 pv;\nuniform mat4 world;\n\nin vec3 attr_position;\n\nvoid main() {\ngl_Position = pv * world * vec4(attr_position, 1.0);\n}\n","#version 300 es\n\nprecision mediump float;\n\nout vec4 frag_color;\n\nvoid main() {\n\nfloat z = gl_FragCoord.z * 10.0;\nfrag_color = vec4(z, z, z, 1.0);\n}\n");return{an:4,nn:n,rn:{en:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),xn:t.getAttribLocation(n,"attr_position")}}}(this.Qt),this.ui=function(t){let n=t.createBuffer();t.bindBuffer(Et,n),t.bufferData(Et,Jt,Vt);let i=t.createBuffer();t.bindBuffer(Et,i),t.bufferData(Et,Qt,Vt);let o=t.createBuffer();t.bindBuffer(Et,o),t.bufferData(Et,Zt,Vt);let e=t.createBuffer();t.bindBuffer(Et,e),t.bufferData(Et,tn,Vt);let r=t.createBuffer();return t.bindBuffer(Gt,r),t.bufferData(Gt,nn,Vt),{bn:n,_i:Jt,Yn:i,di:Qt,vi:o,mi:Zt,pi:e,gi:tn,Kn:r,wi:nn,fn:nn.length}}(this.Qt),this.Vt=new Float32Array(32),this.Et=new Float32Array(32),this.Mi=[],this.An={Sn:l(this.Qt,2048,2048)},this.u=0,this._=0}ri(t){!function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&In)===In&&it(t,i,n)}(this,t),Ft(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Xn)===Xn&&ot(t,i,n)}(this,t),function(t,n){let i=[],o=[];for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&vn)===vn){let e=t.i.k[n],r=t.i.qt[n];r.ft=[],r.yi?(r.yi=!1,G(e.i,r)):r.bi?(G(e.i,r),o.push(r)):i.push(r)}for(let t=0;t<o.length;t++)R(o[t],i,i.length),R(o[t],o,t)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Dn)===Dn&&et(t,n)}(this),Ft(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Nn)===Nn&&Pt(t,n)}(this)}li(t){!function(t,n){let i=[];for(let o=0;o<t.i.o.length;o++)if((t.i.o[o]&Vn)===Vn){if(rt(t.i,o))continue;let e=t.i.On[o];switch(e.K){case 0:e.xi(o)&&i.push(o);break;case 1:e.Xt-=n,e.Xt<0&&i.push(o)}}for(let n of i){t.i.o[n]&=-262145,0===t.i.o[n]&&t.i.h(n);let i=t.i.On[n];i.ki&&i.ki(n),delete t.i.On[n]}}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)4224==(4224&t.i.o[n])&&N(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&pn)===pn&&j(t,n)}(this),function(t,n){1===t.At.Touch0&&(xn[0]=t.yt.Touch0X,xn[1]=t.yt.Touch0Y);for(let n=0;n<t.i.o.length;n++)4224==(4224&t.i.o[n])&&B(t,n)}(this),function(t,n){for(let n of navigator.getGamepads())n&&(t.At[`pad${n.index}_axis_1`]=n.axes[0],t.At[`pad${n.index}_axis_2`]=n.axes[1],t.At[`pad${n.index}_axis_3`]=n.axes[2],t.At[`pad${n.index}_axis_4`]=n.axes[3]);for(let n=0;n<t.i.o.length;n++)4224==(4224&t.i.o[n])&&U(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&mn)===mn&&K(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&en)===en&&C(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Cn)===Cn&&Z(t,i,n)}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&$n)===$n){let i=t.i.k[n],o=t.i.Bn[n],e=t.i.k[o.Zt],r=v([0,0,0],e.i),l=m([0,0,0,0],e.i);S(i.X,i.X,r,o.Ti),$(i.H,i.H,l,o.Ti),i.D=!0}}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)512==(512&t.i.o[i])&&J(t,i,n)}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Wn)==Wn&&kt(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Rn)==Rn&&At(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Yn)==Yn&&St(t,i,n)}(this,t),Ft(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&rn)===rn&&L(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&fn)===fn&&D(t,i,n)}(this,t),function(t,n){t.Ft==window.innerWidth&&t.zt==window.innerHeight||(t.Qn=!0),t.Qn&&(t.Ft=t.ai.width=t.ci.width=window.innerWidth,t.zt=t.ai.height=t.ci.height=window.innerHeight)}(this),function(t,n){t.Mi=[];for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&_n)===_n){let i=t.i.Pn[n],o=t.i.k[n],e=i.J;if(t.Qn)switch(e.K){case 0:V(e,0===i.K?t.Ft/t.zt:i.Zt.m/i.Zt.p);break;case 1:E(e)}f(i.Wn,o.Yt),u(i.en,e.J,i.Wn),v(i.mn,o.i),t.Mi.push(n)}}(this),function(t,n){t.Vt.fill(0),t.Et.fill(0);let i=0;for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&zn)===zn&&Q(t,n,i++)}(this),function(t,n){for(let n of t.Mi){let i=t.i.Pn[n];switch(i.K){case 3:lt(t,i)}}}(this),function(t,n){for(let n of t.Mi){let i=t.i.Pn[n];switch(i.K){case 0:st(t,i);break;case 2:ct(t,i)}}}(this),function(t,n){t.Pt.resetTransform(),t.Pt.clearRect(0,0,t.Ft,t.zt);let i=[0,0,0],o=t.i.Pn[t.Mi[0]];if(o)for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Fn)==Fn){if(v(i,t.i.k[n].i),k(i,i,o.en),i[2]<-1||i[2]>1)continue;t.Pt.setTransform(1,0,0,1,.5*(i[0]+1)*t.Ft,.5*(1-i[1])*t.zt);let e=t.i.jn[n];switch(e.K){case 0:O(t,e);break;case 2:q(t,e)}}}(this),function(t,n){let i=function(t){return $t`<div>${$t`
<div
style="
position: absolute;
top: 1vmin;
left: 1vmin;
background: #000;
color: #fff;
font: 13px Arial;
"
>
<button
onclick="$(${0})"
style="
padding: 1vmin;
background: #000;
color: #fff;
border: none;
"
>
${document.fullscreenElement?"Exit Fullscreen":"Enter Fullscreen"}
</button>
</div>
`} ${function(t){return $t`
<div
style="
position: absolute;
right: 0;
bottom: 0;
left: 0;
height: 10vmin;

display: flex;
justify-content: space-around;
align-items: center;

background: rgba(0, 0, 0, 0.5);
color: #fff;
font: 24px Impact;
font-style: italic;
"
>
<div>Collected: ${t.u}</div>
<div>Missed: ${t._}</div>
</div>
`}(t)}</div>`}(t);i!==jn&&(t.ni.innerHTML=jn=i)}(this)}};!function(t){t.ni.addEventListener("click",(()=>t.ni.requestPointerLock()))}(On),function(i){i.i=new Bn,i.Qn=!0,t(i,[n([Tt(void 0,[0,1,0,0]),Ct(1,.1,1e3)]),Tt([1,2,5],[0,1,0,0])]),t(i,[Tt(void 0,F([0,0,0,0],-45,45,0)),...Dt(i)]),t(i,[Tt(void 0,void 0,[10,1,10]),Ht(i.hi,i.ui,[1,1,0,1])]),t(i,[Tt([0,1,0]),Ht(i.hi,i.ui,[1,1,0,1])])}(On),On.oi(),window.$=o.bind(null,On),window.game=On}();
</script>
